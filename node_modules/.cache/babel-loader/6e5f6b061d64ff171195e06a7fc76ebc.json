{"ast":null,"code":"const got = require('got');\n\nconst request = require('request');\n\nmodule.exports = {\n  getLink: async function (shoe, callback) {\n    try {\n      const response = await got.post('https://2fwotdvm2o-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia%20for%20vanilla%20JavaScript%20(lite)%203.25.1%3Breact%20(16.9.0)%3Breact-instantsearch%20(6.2.0)%3BJS%20Helper%20(3.1.0)&x-algolia-application-id=2FWOTDVM2O&x-algolia-api-key=ac96de6fef0e02bb95d433d8d5c7038a', {\n        headers: {\n          'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15',\n          'Content-Type': 'application/json'\n        },\n        body: '{\"requests\":[{\"indexName\":\"product_variants_v2\",\"params\":\"distinct=true&maxValuesPerFacet=1&page=0&query=' + shoe.styleID + '&facets=%5B%22instant_ship_lowest_price_cents\"}]}',\n        http2: true\n      });\n      var json = JSON.parse(response.body);\n\n      if (json.results[0].hits[0]) {\n        if (json.results[0].hits[0].lowest_price_cents_usd / 100 != 0) {\n          shoe.lowestResellPrice.goat = json.results[0].hits[0].lowest_price_cents_usd / 100;\n        }\n\n        shoe.resellLinks.goat = 'http://www.goat.com/sneakers/' + json.results[0].hits[0].slug;\n        shoe.goatProductId = json.results[0].hits[0].product_template_id;\n      }\n\n      callback();\n    } catch (error) {\n      let err = new Error(\"Could not connect to Goat while searching '\" + shoe.styleID + \"' Error: \", error);\n      console.log(err);\n      callback(err);\n    }\n  },\n  getPrices: async function (shoe, callback) {\n    if (!shoe.resellLinks.goat) {\n      callback();\n    } else {\n      let apiLink = `http://www.goat.com/web-api/v1/product_variants/buy_bar_data?productTemplateId=${shoe.goatProductId}`;\n      let priceMap = {};\n\n      try {\n        const response = await got(apiLink, {\n          headers: {\n            'User-Agent': 'Mozilla/5.0 (Windows NT 6.2; rv:20.0) Gecko/20121202 Firefox/20.0',\n            'Content-Type': 'application/json'\n          },\n          http2: true\n        });\n        var json = JSON.parse(response.body);\n\n        for (var i = 0; i < json.length; i++) {\n          if (json[i].shoeCondition == 'used') continue;\n\n          if (priceMap[json[i].sizeOption.value]) {\n            priceMap[json[i].sizeOption.value] = json[i].lowestPriceCents.amount / 100 < priceMap[json[i].sizeOption.value] ? json[i].lowestPriceCents.amount / 100 : priceMap[json[i].sizeOption.value];\n          } else {\n            priceMap[json[i].sizeOption.value] = json[i].lowestPriceCents.amount / 100;\n          }\n        }\n\n        shoe.resellPrices.goat = priceMap;\n        callback();\n      } catch (error) {\n        console.log(error);\n        let err = new Error(\"Could not connect to Goat while searching '\" + shoe.styleID + \"' Error: \", error);\n        console.log(err);\n        callback(err);\n      }\n    }\n  },\n  getPictures: async function (shoe, callback) {\n    if (!shoe.resellLinks.goat) {\n      callback();\n    } else {\n      let apiLink = shoe.resellLinks.goat.replace('sneakers', 'web-api/v1/product_templates');\n\n      try {\n        const response = await got(apiLink, {\n          headers: {\n            'User-Agent': 'Mozilla/5.0 (Windows NT 6.2; rv:20.0) Gecko/20121202 Firefox/20.0',\n            'Content-Type': 'application/json'\n          },\n          http2: true\n        });\n        var json = JSON.parse(response.body);\n\n        if (json.productTemplateExternalPictures) {\n          if (json.productTemplateExternalPictures[0]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[0].mainPictureUrl);\n          }\n\n          if (json.productTemplateExternalPictures[2]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[2].mainPictureUrl);\n          }\n\n          if (json.productTemplateExternalPictures[5]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[5].mainPictureUrl);\n          }\n\n          if (json.productTemplateExternalPictures[7]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[7].mainPictureUrl);\n          }\n\n          if (json.productTemplateExternalPictures[3]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[3].mainPictureUrl);\n          }\n        }\n\n        callback(shoe);\n      } catch (error) {\n        let err = new Error(\"Could not connect to Goat while grabbing pictures for '\" + shoe.styleID + \"' Error: \", error);\n        console.log(err);\n        callback(err);\n      }\n    }\n  }\n};","map":{"version":3,"names":["got","require","request","module","exports","getLink","shoe","callback","response","post","headers","body","styleID","http2","json","JSON","parse","results","hits","lowest_price_cents_usd","lowestResellPrice","goat","resellLinks","slug","goatProductId","product_template_id","error","err","Error","console","log","getPrices","apiLink","priceMap","i","length","shoeCondition","sizeOption","value","lowestPriceCents","amount","resellPrices","getPictures","replace","productTemplateExternalPictures","imageLinks","push","mainPictureUrl"],"sources":["C:/Users/hamzu/Desktop/React/React projects/react-store/node_modules/sneaks-api/scrapers/goat-scraper.js"],"sourcesContent":["const got = require('got');\nconst request = require('request');\n\n\n\nmodule.exports = {\n  getLink: async function (shoe, callback) {\n    try {\n      const response = await got.post('https://2fwotdvm2o-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia%20for%20vanilla%20JavaScript%20(lite)%203.25.1%3Breact%20(16.9.0)%3Breact-instantsearch%20(6.2.0)%3BJS%20Helper%20(3.1.0)&x-algolia-application-id=2FWOTDVM2O&x-algolia-api-key=ac96de6fef0e02bb95d433d8d5c7038a', {\n        headers: {\n          'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15',\n          'Content-Type': 'application/json'\n        },\n        body: '{\"requests\":[{\"indexName\":\"product_variants_v2\",\"params\":\"distinct=true&maxValuesPerFacet=1&page=0&query=' + shoe.styleID + '&facets=%5B%22instant_ship_lowest_price_cents\"}]}',\n        http2: true,\n      });\n      var json = JSON.parse(response.body);\n      if (json.results[0].hits[0]) {\n        if (json.results[0].hits[0].lowest_price_cents_usd / 100 != 0) {\n          shoe.lowestResellPrice.goat = json.results[0].hits[0].lowest_price_cents_usd / 100;\n        }\n        shoe.resellLinks.goat = 'http://www.goat.com/sneakers/' + json.results[0].hits[0].slug;\n        shoe.goatProductId = json.results[0].hits[0].product_template_id;\n      }\n      callback();\n    } catch (error) {\n      let err = new Error(\"Could not connect to Goat while searching '\" + shoe.styleID + \"' Error: \", error)\n      console.log(err);\n      callback(err)\n    }\n  },\n\n  getPrices: async function (shoe, callback) {\n    if (!shoe.resellLinks.goat) {\n      callback()\n    } else {\n      let apiLink = `http://www.goat.com/web-api/v1/product_variants/buy_bar_data?productTemplateId=${shoe.goatProductId}`;\n      let priceMap = {};\n\n      try {\n        const response = await got(apiLink, {\t\n          headers: {\n            'User-Agent': 'Mozilla/5.0 (Windows NT 6.2; rv:20.0) Gecko/20121202 Firefox/20.0',\n            'Content-Type': 'application/json',\n          },\n          \n          http2: true,\n        });\n        var json = JSON.parse(response.body);\n        for (var i = 0; i < json.length; i++) {\n          if(json[i].shoeCondition == 'used') continue;\n          if(priceMap[json[i].sizeOption.value]){\n            priceMap[json[i].sizeOption.value] = json[i].lowestPriceCents.amount / 100 < priceMap[json[i].sizeOption.value] ? json[i].lowestPriceCents.amount / 100 : priceMap[json[i].sizeOption.value];\n          }\n          else{\n            priceMap[json[i].sizeOption.value] = json[i].lowestPriceCents.amount / 100 ;\n          }\n\n          \n        }\n        shoe.resellPrices.goat = priceMap;\n        callback()\n      } catch (error) {\n        console.log(error);\n        let err = new Error(\"Could not connect to Goat while searching '\" + shoe.styleID + \"' Error: \", error)\n        console.log(err);\n        callback(err)\n      }\n    }\n  },\n\n  getPictures: async function (shoe, callback) {\n    if (!shoe.resellLinks.goat) {\n      callback()\n    } else {\n      let apiLink = shoe.resellLinks.goat.replace('sneakers', 'web-api/v1/product_templates');\n      try {\n        const response = await got(apiLink, {\n          headers: {\n            'User-Agent': 'Mozilla/5.0 (Windows NT 6.2; rv:20.0) Gecko/20121202 Firefox/20.0',\n            'Content-Type': 'application/json',\n          },\n          http2: true,\n        });\n        var json = JSON.parse(response.body);\n        if (json.productTemplateExternalPictures) {\n          if (json.productTemplateExternalPictures[0]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[0].mainPictureUrl);\n          }\n          if (json.productTemplateExternalPictures[2]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[2].mainPictureUrl);\n          }\n          if (json.productTemplateExternalPictures[5]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[5].mainPictureUrl);\n          }\n          if (json.productTemplateExternalPictures[7]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[7].mainPictureUrl);\n          }\n          if (json.productTemplateExternalPictures[3]) {\n            shoe.imageLinks.push(json.productTemplateExternalPictures[3].mainPictureUrl);\n          }\n        }\n        callback(shoe);\n      } catch (error) {\n        let err = new Error(\"Could not connect to Goat while grabbing pictures for '\" + shoe.styleID + \"' Error: \", error)\n        console.log(err);\n        callback(err)\n      }\n    }\n  }\n}\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,KAAD,CAAnB;;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAD,CAAvB;;AAIAE,MAAM,CAACC,OAAP,GAAiB;EACfC,OAAO,EAAE,gBAAgBC,IAAhB,EAAsBC,QAAtB,EAAgC;IACvC,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMR,GAAG,CAACS,IAAJ,CAAS,iSAAT,EAA4S;QACjUC,OAAO,EAAE;UACP,cAAc,yHADP;UAEP,gBAAgB;QAFT,CADwT;QAKjUC,IAAI,EAAE,8GAA8GL,IAAI,CAACM,OAAnH,GAA6H,mDAL8L;QAMjUC,KAAK,EAAE;MAN0T,CAA5S,CAAvB;MAQA,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWR,QAAQ,CAACG,IAApB,CAAX;;MACA,IAAIG,IAAI,CAACG,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqB,CAArB,CAAJ,EAA6B;QAC3B,IAAIJ,IAAI,CAACG,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqB,CAArB,EAAwBC,sBAAxB,GAAiD,GAAjD,IAAwD,CAA5D,EAA+D;UAC7Db,IAAI,CAACc,iBAAL,CAAuBC,IAAvB,GAA8BP,IAAI,CAACG,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqB,CAArB,EAAwBC,sBAAxB,GAAiD,GAA/E;QACD;;QACDb,IAAI,CAACgB,WAAL,CAAiBD,IAAjB,GAAwB,kCAAkCP,IAAI,CAACG,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqB,CAArB,EAAwBK,IAAlF;QACAjB,IAAI,CAACkB,aAAL,GAAqBV,IAAI,CAACG,OAAL,CAAa,CAAb,EAAgBC,IAAhB,CAAqB,CAArB,EAAwBO,mBAA7C;MACD;;MACDlB,QAAQ;IACT,CAlBD,CAkBE,OAAOmB,KAAP,EAAc;MACd,IAAIC,GAAG,GAAG,IAAIC,KAAJ,CAAU,gDAAgDtB,IAAI,CAACM,OAArD,GAA+D,WAAzE,EAAsFc,KAAtF,CAAV;MACAG,OAAO,CAACC,GAAR,CAAYH,GAAZ;MACApB,QAAQ,CAACoB,GAAD,CAAR;IACD;EACF,CAzBc;EA2BfI,SAAS,EAAE,gBAAgBzB,IAAhB,EAAsBC,QAAtB,EAAgC;IACzC,IAAI,CAACD,IAAI,CAACgB,WAAL,CAAiBD,IAAtB,EAA4B;MAC1Bd,QAAQ;IACT,CAFD,MAEO;MACL,IAAIyB,OAAO,GAAI,kFAAiF1B,IAAI,CAACkB,aAAc,EAAnH;MACA,IAAIS,QAAQ,GAAG,EAAf;;MAEA,IAAI;QACF,MAAMzB,QAAQ,GAAG,MAAMR,GAAG,CAACgC,OAAD,EAAU;UAClCtB,OAAO,EAAE;YACP,cAAc,mEADP;YAEP,gBAAgB;UAFT,CADyB;UAMlCG,KAAK,EAAE;QAN2B,CAAV,CAA1B;QAQA,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWR,QAAQ,CAACG,IAApB,CAAX;;QACA,KAAK,IAAIuB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGpB,IAAI,CAACqB,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;UACpC,IAAGpB,IAAI,CAACoB,CAAD,CAAJ,CAAQE,aAAR,IAAyB,MAA5B,EAAoC;;UACpC,IAAGH,QAAQ,CAACnB,IAAI,CAACoB,CAAD,CAAJ,CAAQG,UAAR,CAAmBC,KAApB,CAAX,EAAsC;YACpCL,QAAQ,CAACnB,IAAI,CAACoB,CAAD,CAAJ,CAAQG,UAAR,CAAmBC,KAApB,CAAR,GAAqCxB,IAAI,CAACoB,CAAD,CAAJ,CAAQK,gBAAR,CAAyBC,MAAzB,GAAkC,GAAlC,GAAwCP,QAAQ,CAACnB,IAAI,CAACoB,CAAD,CAAJ,CAAQG,UAAR,CAAmBC,KAApB,CAAhD,GAA6ExB,IAAI,CAACoB,CAAD,CAAJ,CAAQK,gBAAR,CAAyBC,MAAzB,GAAkC,GAA/G,GAAqHP,QAAQ,CAACnB,IAAI,CAACoB,CAAD,CAAJ,CAAQG,UAAR,CAAmBC,KAApB,CAAlK;UACD,CAFD,MAGI;YACFL,QAAQ,CAACnB,IAAI,CAACoB,CAAD,CAAJ,CAAQG,UAAR,CAAmBC,KAApB,CAAR,GAAqCxB,IAAI,CAACoB,CAAD,CAAJ,CAAQK,gBAAR,CAAyBC,MAAzB,GAAkC,GAAvE;UACD;QAGF;;QACDlC,IAAI,CAACmC,YAAL,CAAkBpB,IAAlB,GAAyBY,QAAzB;QACA1B,QAAQ;MACT,CAvBD,CAuBE,OAAOmB,KAAP,EAAc;QACdG,OAAO,CAACC,GAAR,CAAYJ,KAAZ;QACA,IAAIC,GAAG,GAAG,IAAIC,KAAJ,CAAU,gDAAgDtB,IAAI,CAACM,OAArD,GAA+D,WAAzE,EAAsFc,KAAtF,CAAV;QACAG,OAAO,CAACC,GAAR,CAAYH,GAAZ;QACApB,QAAQ,CAACoB,GAAD,CAAR;MACD;IACF;EACF,CAhEc;EAkEfe,WAAW,EAAE,gBAAgBpC,IAAhB,EAAsBC,QAAtB,EAAgC;IAC3C,IAAI,CAACD,IAAI,CAACgB,WAAL,CAAiBD,IAAtB,EAA4B;MAC1Bd,QAAQ;IACT,CAFD,MAEO;MACL,IAAIyB,OAAO,GAAG1B,IAAI,CAACgB,WAAL,CAAiBD,IAAjB,CAAsBsB,OAAtB,CAA8B,UAA9B,EAA0C,8BAA1C,CAAd;;MACA,IAAI;QACF,MAAMnC,QAAQ,GAAG,MAAMR,GAAG,CAACgC,OAAD,EAAU;UAClCtB,OAAO,EAAE;YACP,cAAc,mEADP;YAEP,gBAAgB;UAFT,CADyB;UAKlCG,KAAK,EAAE;QAL2B,CAAV,CAA1B;QAOA,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWR,QAAQ,CAACG,IAApB,CAAX;;QACA,IAAIG,IAAI,CAAC8B,+BAAT,EAA0C;UACxC,IAAI9B,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,CAAJ,EAA6C;YAC3CtC,IAAI,CAACuC,UAAL,CAAgBC,IAAhB,CAAqBhC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,EAAwCG,cAA7D;UACD;;UACD,IAAIjC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,CAAJ,EAA6C;YAC3CtC,IAAI,CAACuC,UAAL,CAAgBC,IAAhB,CAAqBhC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,EAAwCG,cAA7D;UACD;;UACD,IAAIjC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,CAAJ,EAA6C;YAC3CtC,IAAI,CAACuC,UAAL,CAAgBC,IAAhB,CAAqBhC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,EAAwCG,cAA7D;UACD;;UACD,IAAIjC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,CAAJ,EAA6C;YAC3CtC,IAAI,CAACuC,UAAL,CAAgBC,IAAhB,CAAqBhC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,EAAwCG,cAA7D;UACD;;UACD,IAAIjC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,CAAJ,EAA6C;YAC3CtC,IAAI,CAACuC,UAAL,CAAgBC,IAAhB,CAAqBhC,IAAI,CAAC8B,+BAAL,CAAqC,CAArC,EAAwCG,cAA7D;UACD;QACF;;QACDxC,QAAQ,CAACD,IAAD,CAAR;MACD,CA3BD,CA2BE,OAAOoB,KAAP,EAAc;QACd,IAAIC,GAAG,GAAG,IAAIC,KAAJ,CAAU,4DAA4DtB,IAAI,CAACM,OAAjE,GAA2E,WAArF,EAAkGc,KAAlG,CAAV;QACAG,OAAO,CAACC,GAAR,CAAYH,GAAZ;QACApB,QAAQ,CAACoB,GAAD,CAAR;MACD;IACF;EACF;AAxGc,CAAjB"},"metadata":{},"sourceType":"script"}