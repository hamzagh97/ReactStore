{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UnsupportedProtocolError = exports.ReadError = exports.TimeoutError = exports.UploadError = exports.CacheError = exports.HTTPError = exports.MaxRedirectsError = exports.RequestError = exports.setNonEnumerableProperties = exports.knownHookEvents = exports.withoutBody = exports.kIsNormalizedAlready = void 0;\n\nconst util_1 = require(\"util\");\n\nconst stream_1 = require(\"stream\");\n\nconst fs_1 = require(\"fs\");\n\nconst url_1 = require(\"url\");\n\nconst http = require(\"http\");\n\nconst http_1 = require(\"http\");\n\nconst https = require(\"https\");\n\nconst http_timer_1 = require(\"@szmarczak/http-timer\");\n\nconst cacheable_lookup_1 = require(\"cacheable-lookup\");\n\nconst CacheableRequest = require(\"cacheable-request\");\n\nconst decompressResponse = require(\"decompress-response\"); // @ts-expect-error Missing types\n\n\nconst http2wrapper = require(\"http2-wrapper\");\n\nconst lowercaseKeys = require(\"lowercase-keys\");\n\nconst is_1 = require(\"@sindresorhus/is\");\n\nconst get_body_size_1 = require(\"./utils/get-body-size\");\n\nconst is_form_data_1 = require(\"./utils/is-form-data\");\n\nconst proxy_events_1 = require(\"./utils/proxy-events\");\n\nconst timed_out_1 = require(\"./utils/timed-out\");\n\nconst url_to_options_1 = require(\"./utils/url-to-options\");\n\nconst options_to_url_1 = require(\"./utils/options-to-url\");\n\nconst weakable_map_1 = require(\"./utils/weakable-map\");\n\nconst get_buffer_1 = require(\"./utils/get-buffer\");\n\nconst dns_ip_version_1 = require(\"./utils/dns-ip-version\");\n\nconst is_response_ok_1 = require(\"./utils/is-response-ok\");\n\nconst deprecation_warning_1 = require(\"../utils/deprecation-warning\");\n\nconst normalize_arguments_1 = require(\"../as-promise/normalize-arguments\");\n\nconst calculate_retry_delay_1 = require(\"./calculate-retry-delay\");\n\nlet globalDnsCache;\nconst kRequest = Symbol('request');\nconst kResponse = Symbol('response');\nconst kResponseSize = Symbol('responseSize');\nconst kDownloadedSize = Symbol('downloadedSize');\nconst kBodySize = Symbol('bodySize');\nconst kUploadedSize = Symbol('uploadedSize');\nconst kServerResponsesPiped = Symbol('serverResponsesPiped');\nconst kUnproxyEvents = Symbol('unproxyEvents');\nconst kIsFromCache = Symbol('isFromCache');\nconst kCancelTimeouts = Symbol('cancelTimeouts');\nconst kStartedReading = Symbol('startedReading');\nconst kStopReading = Symbol('stopReading');\nconst kTriggerRead = Symbol('triggerRead');\nconst kBody = Symbol('body');\nconst kJobs = Symbol('jobs');\nconst kOriginalResponse = Symbol('originalResponse');\nconst kRetryTimeout = Symbol('retryTimeout');\nexports.kIsNormalizedAlready = Symbol('isNormalizedAlready');\nconst supportsBrotli = is_1.default.string(process.versions.brotli);\nexports.withoutBody = new Set(['GET', 'HEAD']);\nexports.knownHookEvents = ['init', 'beforeRequest', 'beforeRedirect', 'beforeError', 'beforeRetry', // Promise-Only\n'afterResponse'];\n\nfunction validateSearchParameters(searchParameters) {\n  // eslint-disable-next-line guard-for-in\n  for (const key in searchParameters) {\n    const value = searchParameters[key];\n\n    if (!is_1.default.string(value) && !is_1.default.number(value) && !is_1.default.boolean(value) && !is_1.default.null_(value) && !is_1.default.undefined(value)) {\n      throw new TypeError(`The \\`searchParams\\` value '${String(value)}' must be a string, number, boolean or null`);\n    }\n  }\n}\n\nfunction isClientRequest(clientRequest) {\n  return is_1.default.object(clientRequest) && !('statusCode' in clientRequest);\n}\n\nconst cacheableStore = new weakable_map_1.default();\n\nconst waitForOpenFile = async file => new Promise((resolve, reject) => {\n  const onError = error => {\n    reject(error);\n  }; // Node.js 12 has incomplete types\n\n\n  if (!file.pending) {\n    resolve();\n  }\n\n  file.once('error', onError);\n  file.once('ready', () => {\n    file.off('error', onError);\n    resolve();\n  });\n});\n\nconst redirectCodes = new Set([300, 301, 302, 303, 304, 307, 308]);\nconst nonEnumerableProperties = ['context', 'body', 'json', 'form'];\n\nexports.setNonEnumerableProperties = (sources, to) => {\n  // Non enumerable properties shall not be merged\n  const properties = {};\n\n  for (const source of sources) {\n    if (!source) {\n      continue;\n    }\n\n    for (const name of nonEnumerableProperties) {\n      if (!(name in source)) {\n        continue;\n      }\n\n      properties[name] = {\n        writable: true,\n        configurable: true,\n        enumerable: false,\n        // @ts-expect-error TS doesn't see the check above\n        value: source[name]\n      };\n    }\n  }\n\n  Object.defineProperties(to, properties);\n};\n/**\nAn error to be thrown when a request fails.\nContains a `code` property with error class code, like `ECONNREFUSED`.\n*/\n\n\nclass RequestError extends Error {\n  constructor(message, error, self) {\n    var _a, _b;\n\n    super(message);\n    Error.captureStackTrace(this, this.constructor);\n    this.name = 'RequestError';\n    this.code = (_a = error.code) !== null && _a !== void 0 ? _a : 'ERR_GOT_REQUEST_ERROR';\n\n    if (self instanceof Request) {\n      Object.defineProperty(this, 'request', {\n        enumerable: false,\n        value: self\n      });\n      Object.defineProperty(this, 'response', {\n        enumerable: false,\n        value: self[kResponse]\n      });\n      Object.defineProperty(this, 'options', {\n        // This fails because of TS 3.7.2 useDefineForClassFields\n        // Ref: https://github.com/microsoft/TypeScript/issues/34972\n        enumerable: false,\n        value: self.options\n      });\n    } else {\n      Object.defineProperty(this, 'options', {\n        // This fails because of TS 3.7.2 useDefineForClassFields\n        // Ref: https://github.com/microsoft/TypeScript/issues/34972\n        enumerable: false,\n        value: self\n      });\n    }\n\n    this.timings = (_b = this.request) === null || _b === void 0 ? void 0 : _b.timings; // Recover the original stacktrace\n\n    if (is_1.default.string(error.stack) && is_1.default.string(this.stack)) {\n      const indexOfMessage = this.stack.indexOf(this.message) + this.message.length;\n      const thisStackTrace = this.stack.slice(indexOfMessage).split('\\n').reverse();\n      const errorStackTrace = error.stack.slice(error.stack.indexOf(error.message) + error.message.length).split('\\n').reverse(); // Remove duplicated traces\n\n      while (errorStackTrace.length !== 0 && errorStackTrace[0] === thisStackTrace[0]) {\n        thisStackTrace.shift();\n      }\n\n      this.stack = `${this.stack.slice(0, indexOfMessage)}${thisStackTrace.reverse().join('\\n')}${errorStackTrace.reverse().join('\\n')}`;\n    }\n  }\n\n}\n\nexports.RequestError = RequestError;\n/**\nAn error to be thrown when the server redirects you more than ten times.\nIncludes a `response` property.\n*/\n\nclass MaxRedirectsError extends RequestError {\n  constructor(request) {\n    super(`Redirected ${request.options.maxRedirects} times. Aborting.`, {}, request);\n    this.name = 'MaxRedirectsError';\n    this.code = 'ERR_TOO_MANY_REDIRECTS';\n  }\n\n}\n\nexports.MaxRedirectsError = MaxRedirectsError;\n/**\nAn error to be thrown when the server response code is not 2xx nor 3xx if `options.followRedirect` is `true`, but always except for 304.\nIncludes a `response` property.\n*/\n\nclass HTTPError extends RequestError {\n  constructor(response) {\n    super(`Response code ${response.statusCode} (${response.statusMessage})`, {}, response.request);\n    this.name = 'HTTPError';\n    this.code = 'ERR_NON_2XX_3XX_RESPONSE';\n  }\n\n}\n\nexports.HTTPError = HTTPError;\n/**\nAn error to be thrown when a cache method fails.\nFor example, if the database goes down or there's a filesystem error.\n*/\n\nclass CacheError extends RequestError {\n  constructor(error, request) {\n    super(error.message, error, request);\n    this.name = 'CacheError';\n    this.code = this.code === 'ERR_GOT_REQUEST_ERROR' ? 'ERR_CACHE_ACCESS' : this.code;\n  }\n\n}\n\nexports.CacheError = CacheError;\n/**\nAn error to be thrown when the request body is a stream and an error occurs while reading from that stream.\n*/\n\nclass UploadError extends RequestError {\n  constructor(error, request) {\n    super(error.message, error, request);\n    this.name = 'UploadError';\n    this.code = this.code === 'ERR_GOT_REQUEST_ERROR' ? 'ERR_UPLOAD' : this.code;\n  }\n\n}\n\nexports.UploadError = UploadError;\n/**\nAn error to be thrown when the request is aborted due to a timeout.\nIncludes an `event` and `timings` property.\n*/\n\nclass TimeoutError extends RequestError {\n  constructor(error, timings, request) {\n    super(error.message, error, request);\n    this.name = 'TimeoutError';\n    this.event = error.event;\n    this.timings = timings;\n  }\n\n}\n\nexports.TimeoutError = TimeoutError;\n/**\nAn error to be thrown when reading from response stream fails.\n*/\n\nclass ReadError extends RequestError {\n  constructor(error, request) {\n    super(error.message, error, request);\n    this.name = 'ReadError';\n    this.code = this.code === 'ERR_GOT_REQUEST_ERROR' ? 'ERR_READING_RESPONSE_STREAM' : this.code;\n  }\n\n}\n\nexports.ReadError = ReadError;\n/**\nAn error to be thrown when given an unsupported protocol.\n*/\n\nclass UnsupportedProtocolError extends RequestError {\n  constructor(options) {\n    super(`Unsupported protocol \"${options.url.protocol}\"`, {}, options);\n    this.name = 'UnsupportedProtocolError';\n    this.code = 'ERR_UNSUPPORTED_PROTOCOL';\n  }\n\n}\n\nexports.UnsupportedProtocolError = UnsupportedProtocolError;\nconst proxiedRequestEvents = ['socket', 'connect', 'continue', 'information', 'upgrade', 'timeout'];\n\nclass Request extends stream_1.Duplex {\n  constructor(url) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let defaults = arguments.length > 2 ? arguments[2] : undefined;\n    super({\n      // This must be false, to enable throwing after destroy\n      // It is used for retry logic in Promise API\n      autoDestroy: false,\n      // It needs to be zero because we're just proxying the data to another stream\n      highWaterMark: 0\n    });\n    this[kDownloadedSize] = 0;\n    this[kUploadedSize] = 0;\n    this.requestInitialized = false;\n    this[kServerResponsesPiped] = new Set();\n    this.redirects = [];\n    this[kStopReading] = false;\n    this[kTriggerRead] = false;\n    this[kJobs] = [];\n    this.retryCount = 0; // TODO: Remove this when targeting Node.js >= 12\n\n    this._progressCallbacks = [];\n\n    const unlockWrite = () => this._unlockWrite();\n\n    const lockWrite = () => this._lockWrite();\n\n    this.on('pipe', source => {\n      source.prependListener('data', unlockWrite);\n      source.on('data', lockWrite);\n      source.prependListener('end', unlockWrite);\n      source.on('end', lockWrite);\n    });\n    this.on('unpipe', source => {\n      source.off('data', unlockWrite);\n      source.off('data', lockWrite);\n      source.off('end', unlockWrite);\n      source.off('end', lockWrite);\n    });\n    this.on('pipe', source => {\n      if (source instanceof http_1.IncomingMessage) {\n        this.options.headers = { ...source.headers,\n          ...this.options.headers\n        };\n      }\n    });\n    const {\n      json,\n      body,\n      form\n    } = options;\n\n    if (json || body || form) {\n      this._lockWrite();\n    }\n\n    if (exports.kIsNormalizedAlready in options) {\n      this.options = options;\n    } else {\n      try {\n        // @ts-expect-error Common TypeScript bug saying that `this.constructor` is not accessible\n        this.options = this.constructor.normalizeArguments(url, options, defaults);\n      } catch (error) {\n        // TODO: Move this to `_destroy()`\n        if (is_1.default.nodeStream(options.body)) {\n          options.body.destroy();\n        }\n\n        this.destroy(error);\n        return;\n      }\n    }\n\n    (async () => {\n      var _a;\n\n      try {\n        if (this.options.body instanceof fs_1.ReadStream) {\n          await waitForOpenFile(this.options.body);\n        }\n\n        const {\n          url: normalizedURL\n        } = this.options;\n\n        if (!normalizedURL) {\n          throw new TypeError('Missing `url` property');\n        }\n\n        this.requestUrl = normalizedURL.toString();\n        decodeURI(this.requestUrl);\n        await this._finalizeBody();\n        await this._makeRequest();\n\n        if (this.destroyed) {\n          (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.destroy();\n          return;\n        } // Queued writes etc.\n\n\n        for (const job of this[kJobs]) {\n          job();\n        } // Prevent memory leak\n\n\n        this[kJobs].length = 0;\n        this.requestInitialized = true;\n      } catch (error) {\n        if (error instanceof RequestError) {\n          this._beforeError(error);\n\n          return;\n        } // This is a workaround for https://github.com/nodejs/node/issues/33335\n\n\n        if (!this.destroyed) {\n          this.destroy(error);\n        }\n      }\n    })();\n  }\n\n  static normalizeArguments(url, options, defaults) {\n    var _a, _b, _c, _d, _e;\n\n    const rawOptions = options;\n\n    if (is_1.default.object(url) && !is_1.default.urlInstance(url)) {\n      options = { ...defaults,\n        ...url,\n        ...options\n      };\n    } else {\n      if (url && options && options.url !== undefined) {\n        throw new TypeError('The `url` option is mutually exclusive with the `input` argument');\n      }\n\n      options = { ...defaults,\n        ...options\n      };\n\n      if (url !== undefined) {\n        options.url = url;\n      }\n\n      if (is_1.default.urlInstance(options.url)) {\n        options.url = new url_1.URL(options.url.toString());\n      }\n    } // TODO: Deprecate URL options in Got 12.\n    // Support extend-specific options\n\n\n    if (options.cache === false) {\n      options.cache = undefined;\n    }\n\n    if (options.dnsCache === false) {\n      options.dnsCache = undefined;\n    } // Nice type assertions\n\n\n    is_1.assert.any([is_1.default.string, is_1.default.undefined], options.method);\n    is_1.assert.any([is_1.default.object, is_1.default.undefined], options.headers);\n    is_1.assert.any([is_1.default.string, is_1.default.urlInstance, is_1.default.undefined], options.prefixUrl);\n    is_1.assert.any([is_1.default.object, is_1.default.undefined], options.cookieJar);\n    is_1.assert.any([is_1.default.object, is_1.default.string, is_1.default.undefined], options.searchParams);\n    is_1.assert.any([is_1.default.object, is_1.default.string, is_1.default.undefined], options.cache);\n    is_1.assert.any([is_1.default.object, is_1.default.number, is_1.default.undefined], options.timeout);\n    is_1.assert.any([is_1.default.object, is_1.default.undefined], options.context);\n    is_1.assert.any([is_1.default.object, is_1.default.undefined], options.hooks);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.decompress);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.ignoreInvalidCookies);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.followRedirect);\n    is_1.assert.any([is_1.default.number, is_1.default.undefined], options.maxRedirects);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.throwHttpErrors);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.http2);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.allowGetBody);\n    is_1.assert.any([is_1.default.string, is_1.default.undefined], options.localAddress);\n    is_1.assert.any([dns_ip_version_1.isDnsLookupIpVersion, is_1.default.undefined], options.dnsLookupIpVersion);\n    is_1.assert.any([is_1.default.object, is_1.default.undefined], options.https);\n    is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.rejectUnauthorized);\n\n    if (options.https) {\n      is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.https.rejectUnauthorized);\n      is_1.assert.any([is_1.default.function_, is_1.default.undefined], options.https.checkServerIdentity);\n      is_1.assert.any([is_1.default.string, is_1.default.object, is_1.default.array, is_1.default.undefined], options.https.certificateAuthority);\n      is_1.assert.any([is_1.default.string, is_1.default.object, is_1.default.array, is_1.default.undefined], options.https.key);\n      is_1.assert.any([is_1.default.string, is_1.default.object, is_1.default.array, is_1.default.undefined], options.https.certificate);\n      is_1.assert.any([is_1.default.string, is_1.default.undefined], options.https.passphrase);\n      is_1.assert.any([is_1.default.string, is_1.default.buffer, is_1.default.array, is_1.default.undefined], options.https.pfx);\n    }\n\n    is_1.assert.any([is_1.default.object, is_1.default.undefined], options.cacheOptions); // `options.method`\n\n    if (is_1.default.string(options.method)) {\n      options.method = options.method.toUpperCase();\n    } else {\n      options.method = 'GET';\n    } // `options.headers`\n\n\n    if (options.headers === (defaults === null || defaults === void 0 ? void 0 : defaults.headers)) {\n      options.headers = { ...options.headers\n      };\n    } else {\n      options.headers = lowercaseKeys({ ...(defaults === null || defaults === void 0 ? void 0 : defaults.headers),\n        ...options.headers\n      });\n    } // Disallow legacy `url.Url`\n\n\n    if ('slashes' in options) {\n      throw new TypeError('The legacy `url.Url` has been deprecated. Use `URL` instead.');\n    } // `options.auth`\n\n\n    if ('auth' in options) {\n      throw new TypeError('Parameter `auth` is deprecated. Use `username` / `password` instead.');\n    } // `options.searchParams`\n\n\n    if ('searchParams' in options) {\n      if (options.searchParams && options.searchParams !== (defaults === null || defaults === void 0 ? void 0 : defaults.searchParams)) {\n        let searchParameters;\n\n        if (is_1.default.string(options.searchParams) || options.searchParams instanceof url_1.URLSearchParams) {\n          searchParameters = new url_1.URLSearchParams(options.searchParams);\n        } else {\n          validateSearchParameters(options.searchParams);\n          searchParameters = new url_1.URLSearchParams(); // eslint-disable-next-line guard-for-in\n\n          for (const key in options.searchParams) {\n            const value = options.searchParams[key];\n\n            if (value === null) {\n              searchParameters.append(key, '');\n            } else if (value !== undefined) {\n              searchParameters.append(key, value);\n            }\n          }\n        } // `normalizeArguments()` is also used to merge options\n\n\n        (_a = defaults === null || defaults === void 0 ? void 0 : defaults.searchParams) === null || _a === void 0 ? void 0 : _a.forEach((value, key) => {\n          // Only use default if one isn't already defined\n          if (!searchParameters.has(key)) {\n            searchParameters.append(key, value);\n          }\n        });\n        options.searchParams = searchParameters;\n      }\n    } // `options.username` & `options.password`\n\n\n    options.username = (_b = options.username) !== null && _b !== void 0 ? _b : '';\n    options.password = (_c = options.password) !== null && _c !== void 0 ? _c : ''; // `options.prefixUrl` & `options.url`\n\n    if (is_1.default.undefined(options.prefixUrl)) {\n      options.prefixUrl = (_d = defaults === null || defaults === void 0 ? void 0 : defaults.prefixUrl) !== null && _d !== void 0 ? _d : '';\n    } else {\n      options.prefixUrl = options.prefixUrl.toString();\n\n      if (options.prefixUrl !== '' && !options.prefixUrl.endsWith('/')) {\n        options.prefixUrl += '/';\n      }\n    }\n\n    if (is_1.default.string(options.url)) {\n      if (options.url.startsWith('/')) {\n        throw new Error('`input` must not start with a slash when using `prefixUrl`');\n      }\n\n      options.url = options_to_url_1.default(options.prefixUrl + options.url, options);\n    } else if (is_1.default.undefined(options.url) && options.prefixUrl !== '' || options.protocol) {\n      options.url = options_to_url_1.default(options.prefixUrl, options);\n    }\n\n    if (options.url) {\n      if ('port' in options) {\n        delete options.port;\n      } // Make it possible to change `options.prefixUrl`\n\n\n      let {\n        prefixUrl\n      } = options;\n      Object.defineProperty(options, 'prefixUrl', {\n        set: value => {\n          const url = options.url;\n\n          if (!url.href.startsWith(value)) {\n            throw new Error(`Cannot change \\`prefixUrl\\` from ${prefixUrl} to ${value}: ${url.href}`);\n          }\n\n          options.url = new url_1.URL(value + url.href.slice(prefixUrl.length));\n          prefixUrl = value;\n        },\n        get: () => prefixUrl\n      }); // Support UNIX sockets\n\n      let {\n        protocol\n      } = options.url;\n\n      if (protocol === 'unix:') {\n        protocol = 'http:';\n        options.url = new url_1.URL(`http://unix${options.url.pathname}${options.url.search}`);\n      } // Set search params\n\n\n      if (options.searchParams) {\n        // eslint-disable-next-line @typescript-eslint/no-base-to-string\n        options.url.search = options.searchParams.toString();\n      } // Protocol check\n\n\n      if (protocol !== 'http:' && protocol !== 'https:') {\n        throw new UnsupportedProtocolError(options);\n      } // Update `username`\n\n\n      if (options.username === '') {\n        options.username = options.url.username;\n      } else {\n        options.url.username = options.username;\n      } // Update `password`\n\n\n      if (options.password === '') {\n        options.password = options.url.password;\n      } else {\n        options.url.password = options.password;\n      }\n    } // `options.cookieJar`\n\n\n    const {\n      cookieJar\n    } = options;\n\n    if (cookieJar) {\n      let {\n        setCookie,\n        getCookieString\n      } = cookieJar;\n      is_1.assert.function_(setCookie);\n      is_1.assert.function_(getCookieString);\n      /* istanbul ignore next: Horrible `tough-cookie` v3 check */\n\n      if (setCookie.length === 4 && getCookieString.length === 0) {\n        setCookie = util_1.promisify(setCookie.bind(options.cookieJar));\n        getCookieString = util_1.promisify(getCookieString.bind(options.cookieJar));\n        options.cookieJar = {\n          setCookie,\n          getCookieString: getCookieString\n        };\n      }\n    } // `options.cache`\n\n\n    const {\n      cache\n    } = options;\n\n    if (cache) {\n      if (!cacheableStore.has(cache)) {\n        cacheableStore.set(cache, new CacheableRequest((requestOptions, handler) => {\n          const result = requestOptions[kRequest](requestOptions, handler); // TODO: remove this when `cacheable-request` supports async request functions.\n\n          if (is_1.default.promise(result)) {\n            // @ts-expect-error\n            // We only need to implement the error handler in order to support HTTP2 caching.\n            // The result will be a promise anyway.\n            result.once = (event, handler) => {\n              if (event === 'error') {\n                result.catch(handler);\n              } else if (event === 'abort') {\n                // The empty catch is needed here in case when\n                // it rejects before it's `await`ed in `_makeRequest`.\n                (async () => {\n                  try {\n                    const request = await result;\n                    request.once('abort', handler);\n                  } catch (_a) {}\n                })();\n              } else {\n                /* istanbul ignore next: safety check */\n                throw new Error(`Unknown HTTP2 promise event: ${event}`);\n              }\n\n              return result;\n            };\n          }\n\n          return result;\n        }, cache));\n      }\n    } // `options.cacheOptions`\n\n\n    options.cacheOptions = { ...options.cacheOptions\n    }; // `options.dnsCache`\n\n    if (options.dnsCache === true) {\n      if (!globalDnsCache) {\n        globalDnsCache = new cacheable_lookup_1.default();\n      }\n\n      options.dnsCache = globalDnsCache;\n    } else if (!is_1.default.undefined(options.dnsCache) && !options.dnsCache.lookup) {\n      throw new TypeError(`Parameter \\`dnsCache\\` must be a CacheableLookup instance or a boolean, got ${is_1.default(options.dnsCache)}`);\n    } // `options.timeout`\n\n\n    if (is_1.default.number(options.timeout)) {\n      options.timeout = {\n        request: options.timeout\n      };\n    } else if (defaults && options.timeout !== defaults.timeout) {\n      options.timeout = { ...defaults.timeout,\n        ...options.timeout\n      };\n    } else {\n      options.timeout = { ...options.timeout\n      };\n    } // `options.context`\n\n\n    if (!options.context) {\n      options.context = {};\n    } // `options.hooks`\n\n\n    const areHooksDefault = options.hooks === (defaults === null || defaults === void 0 ? void 0 : defaults.hooks);\n    options.hooks = { ...options.hooks\n    };\n\n    for (const event of exports.knownHookEvents) {\n      if (event in options.hooks) {\n        if (is_1.default.array(options.hooks[event])) {\n          // See https://github.com/microsoft/TypeScript/issues/31445#issuecomment-576929044\n          options.hooks[event] = [...options.hooks[event]];\n        } else {\n          throw new TypeError(`Parameter \\`${event}\\` must be an Array, got ${is_1.default(options.hooks[event])}`);\n        }\n      } else {\n        options.hooks[event] = [];\n      }\n    }\n\n    if (defaults && !areHooksDefault) {\n      for (const event of exports.knownHookEvents) {\n        const defaultHooks = defaults.hooks[event];\n\n        if (defaultHooks.length > 0) {\n          // See https://github.com/microsoft/TypeScript/issues/31445#issuecomment-576929044\n          options.hooks[event] = [...defaults.hooks[event], ...options.hooks[event]];\n        }\n      }\n    } // DNS options\n\n\n    if ('family' in options) {\n      deprecation_warning_1.default('\"options.family\" was never documented, please use \"options.dnsLookupIpVersion\"');\n    } // HTTPS options\n\n\n    if (defaults === null || defaults === void 0 ? void 0 : defaults.https) {\n      options.https = { ...defaults.https,\n        ...options.https\n      };\n    }\n\n    if ('rejectUnauthorized' in options) {\n      deprecation_warning_1.default('\"options.rejectUnauthorized\" is now deprecated, please use \"options.https.rejectUnauthorized\"');\n    }\n\n    if ('checkServerIdentity' in options) {\n      deprecation_warning_1.default('\"options.checkServerIdentity\" was never documented, please use \"options.https.checkServerIdentity\"');\n    }\n\n    if ('ca' in options) {\n      deprecation_warning_1.default('\"options.ca\" was never documented, please use \"options.https.certificateAuthority\"');\n    }\n\n    if ('key' in options) {\n      deprecation_warning_1.default('\"options.key\" was never documented, please use \"options.https.key\"');\n    }\n\n    if ('cert' in options) {\n      deprecation_warning_1.default('\"options.cert\" was never documented, please use \"options.https.certificate\"');\n    }\n\n    if ('passphrase' in options) {\n      deprecation_warning_1.default('\"options.passphrase\" was never documented, please use \"options.https.passphrase\"');\n    }\n\n    if ('pfx' in options) {\n      deprecation_warning_1.default('\"options.pfx\" was never documented, please use \"options.https.pfx\"');\n    } // Other options\n\n\n    if ('followRedirects' in options) {\n      throw new TypeError('The `followRedirects` option does not exist. Use `followRedirect` instead.');\n    }\n\n    if (options.agent) {\n      for (const key in options.agent) {\n        if (key !== 'http' && key !== 'https' && key !== 'http2') {\n          throw new TypeError(`Expected the \\`options.agent\\` properties to be \\`http\\`, \\`https\\` or \\`http2\\`, got \\`${key}\\``);\n        }\n      }\n    }\n\n    options.maxRedirects = (_e = options.maxRedirects) !== null && _e !== void 0 ? _e : 0; // Set non-enumerable properties\n\n    exports.setNonEnumerableProperties([defaults, rawOptions], options);\n    return normalize_arguments_1.default(options, defaults);\n  }\n\n  _lockWrite() {\n    const onLockedWrite = () => {\n      throw new TypeError('The payload has been already provided');\n    };\n\n    this.write = onLockedWrite;\n    this.end = onLockedWrite;\n  }\n\n  _unlockWrite() {\n    this.write = super.write;\n    this.end = super.end;\n  }\n\n  async _finalizeBody() {\n    const {\n      options\n    } = this;\n    const {\n      headers\n    } = options;\n    const isForm = !is_1.default.undefined(options.form);\n    const isJSON = !is_1.default.undefined(options.json);\n    const isBody = !is_1.default.undefined(options.body);\n    const hasPayload = isForm || isJSON || isBody;\n    const cannotHaveBody = exports.withoutBody.has(options.method) && !(options.method === 'GET' && options.allowGetBody);\n    this._cannotHaveBody = cannotHaveBody;\n\n    if (hasPayload) {\n      if (cannotHaveBody) {\n        throw new TypeError(`The \\`${options.method}\\` method cannot be used with a body`);\n      }\n\n      if ([isBody, isForm, isJSON].filter(isTrue => isTrue).length > 1) {\n        throw new TypeError('The `body`, `json` and `form` options are mutually exclusive');\n      }\n\n      if (isBody && !(options.body instanceof stream_1.Readable) && !is_1.default.string(options.body) && !is_1.default.buffer(options.body) && !is_form_data_1.default(options.body)) {\n        throw new TypeError('The `body` option must be a stream.Readable, string or Buffer');\n      }\n\n      if (isForm && !is_1.default.object(options.form)) {\n        throw new TypeError('The `form` option must be an Object');\n      }\n\n      {\n        // Serialize body\n        const noContentType = !is_1.default.string(headers['content-type']);\n\n        if (isBody) {\n          // Special case for https://github.com/form-data/form-data\n          if (is_form_data_1.default(options.body) && noContentType) {\n            headers['content-type'] = `multipart/form-data; boundary=${options.body.getBoundary()}`;\n          }\n\n          this[kBody] = options.body;\n        } else if (isForm) {\n          if (noContentType) {\n            headers['content-type'] = 'application/x-www-form-urlencoded';\n          }\n\n          this[kBody] = new url_1.URLSearchParams(options.form).toString();\n        } else {\n          if (noContentType) {\n            headers['content-type'] = 'application/json';\n          }\n\n          this[kBody] = options.stringifyJson(options.json);\n        }\n\n        const uploadBodySize = await get_body_size_1.default(this[kBody], options.headers); // See https://tools.ietf.org/html/rfc7230#section-3.3.2\n        // A user agent SHOULD send a Content-Length in a request message when\n        // no Transfer-Encoding is sent and the request method defines a meaning\n        // for an enclosed payload body.  For example, a Content-Length header\n        // field is normally sent in a POST request even when the value is 0\n        // (indicating an empty payload body).  A user agent SHOULD NOT send a\n        // Content-Length header field when the request message does not contain\n        // a payload body and the method semantics do not anticipate such a\n        // body.\n\n        if (is_1.default.undefined(headers['content-length']) && is_1.default.undefined(headers['transfer-encoding'])) {\n          if (!cannotHaveBody && !is_1.default.undefined(uploadBodySize)) {\n            headers['content-length'] = String(uploadBodySize);\n          }\n        }\n      }\n    } else if (cannotHaveBody) {\n      this._lockWrite();\n    } else {\n      this._unlockWrite();\n    }\n\n    this[kBodySize] = Number(headers['content-length']) || undefined;\n  }\n\n  async _onResponseBase(response) {\n    const {\n      options\n    } = this;\n    const {\n      url\n    } = options;\n    this[kOriginalResponse] = response;\n\n    if (options.decompress) {\n      response = decompressResponse(response);\n    }\n\n    const statusCode = response.statusCode;\n    const typedResponse = response;\n    typedResponse.statusMessage = typedResponse.statusMessage ? typedResponse.statusMessage : http.STATUS_CODES[statusCode];\n    typedResponse.url = options.url.toString();\n    typedResponse.requestUrl = this.requestUrl;\n    typedResponse.redirectUrls = this.redirects;\n    typedResponse.request = this;\n    typedResponse.isFromCache = response.fromCache || false;\n    typedResponse.ip = this.ip;\n    typedResponse.retryCount = this.retryCount;\n    this[kIsFromCache] = typedResponse.isFromCache;\n    this[kResponseSize] = Number(response.headers['content-length']) || undefined;\n    this[kResponse] = response;\n    response.once('end', () => {\n      this[kResponseSize] = this[kDownloadedSize];\n      this.emit('downloadProgress', this.downloadProgress);\n    });\n    response.once('error', error => {\n      // Force clean-up, because some packages don't do this.\n      // TODO: Fix decompress-response\n      response.destroy();\n\n      this._beforeError(new ReadError(error, this));\n    });\n    response.once('aborted', () => {\n      this._beforeError(new ReadError({\n        name: 'Error',\n        message: 'The server aborted pending request',\n        code: 'ECONNRESET'\n      }, this));\n    });\n    this.emit('downloadProgress', this.downloadProgress);\n    const rawCookies = response.headers['set-cookie'];\n\n    if (is_1.default.object(options.cookieJar) && rawCookies) {\n      let promises = rawCookies.map(async rawCookie => options.cookieJar.setCookie(rawCookie, url.toString()));\n\n      if (options.ignoreInvalidCookies) {\n        promises = promises.map(async p => p.catch(() => {}));\n      }\n\n      try {\n        await Promise.all(promises);\n      } catch (error) {\n        this._beforeError(error);\n\n        return;\n      }\n    }\n\n    if (options.followRedirect && response.headers.location && redirectCodes.has(statusCode)) {\n      // We're being redirected, we don't care about the response.\n      // It'd be best to abort the request, but we can't because\n      // we would have to sacrifice the TCP connection. We don't want that.\n      response.resume();\n\n      if (this[kRequest]) {\n        this[kCancelTimeouts](); // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n\n        delete this[kRequest];\n        this[kUnproxyEvents]();\n      }\n\n      const shouldBeGet = statusCode === 303 && options.method !== 'GET' && options.method !== 'HEAD';\n\n      if (shouldBeGet || !options.methodRewriting) {\n        // Server responded with \"see other\", indicating that the resource exists at another location,\n        // and the client should request it from that location via GET or HEAD.\n        options.method = 'GET';\n\n        if ('body' in options) {\n          delete options.body;\n        }\n\n        if ('json' in options) {\n          delete options.json;\n        }\n\n        if ('form' in options) {\n          delete options.form;\n        }\n\n        this[kBody] = undefined;\n        delete options.headers['content-length'];\n      }\n\n      if (this.redirects.length >= options.maxRedirects) {\n        this._beforeError(new MaxRedirectsError(this));\n\n        return;\n      }\n\n      try {\n        // Do not remove. See https://github.com/sindresorhus/got/pull/214\n        const redirectBuffer = Buffer.from(response.headers.location, 'binary').toString(); // Handles invalid URLs. See https://github.com/sindresorhus/got/issues/604\n\n        const redirectUrl = new url_1.URL(redirectBuffer, url);\n        const redirectString = redirectUrl.toString();\n        decodeURI(redirectString); // eslint-disable-next-line no-inner-declarations\n\n        function isUnixSocketURL(url) {\n          return url.protocol === 'unix:' || url.hostname === 'unix';\n        }\n\n        if (!isUnixSocketURL(url) && isUnixSocketURL(redirectUrl)) {\n          this._beforeError(new RequestError('Cannot redirect to UNIX socket', {}, this));\n\n          return;\n        } // Redirecting to a different site, clear sensitive data.\n\n\n        if (redirectUrl.hostname !== url.hostname || redirectUrl.port !== url.port) {\n          if ('host' in options.headers) {\n            delete options.headers.host;\n          }\n\n          if ('cookie' in options.headers) {\n            delete options.headers.cookie;\n          }\n\n          if ('authorization' in options.headers) {\n            delete options.headers.authorization;\n          }\n\n          if (options.username || options.password) {\n            options.username = '';\n            options.password = '';\n          }\n        } else {\n          redirectUrl.username = options.username;\n          redirectUrl.password = options.password;\n        }\n\n        this.redirects.push(redirectString);\n        options.url = redirectUrl;\n\n        for (const hook of options.hooks.beforeRedirect) {\n          // eslint-disable-next-line no-await-in-loop\n          await hook(options, typedResponse);\n        }\n\n        this.emit('redirect', typedResponse, options);\n        await this._makeRequest();\n      } catch (error) {\n        this._beforeError(error);\n\n        return;\n      }\n\n      return;\n    }\n\n    if (options.isStream && options.throwHttpErrors && !is_response_ok_1.isResponseOk(typedResponse)) {\n      this._beforeError(new HTTPError(typedResponse));\n\n      return;\n    }\n\n    response.on('readable', () => {\n      if (this[kTriggerRead]) {\n        this._read();\n      }\n    });\n    this.on('resume', () => {\n      response.resume();\n    });\n    this.on('pause', () => {\n      response.pause();\n    });\n    response.once('end', () => {\n      this.push(null);\n    });\n    this.emit('response', response);\n\n    for (const destination of this[kServerResponsesPiped]) {\n      if (destination.headersSent) {\n        continue;\n      } // eslint-disable-next-line guard-for-in\n\n\n      for (const key in response.headers) {\n        const isAllowed = options.decompress ? key !== 'content-encoding' : true;\n        const value = response.headers[key];\n\n        if (isAllowed) {\n          destination.setHeader(key, value);\n        }\n      }\n\n      destination.statusCode = statusCode;\n    }\n  }\n\n  async _onResponse(response) {\n    try {\n      await this._onResponseBase(response);\n    } catch (error) {\n      /* istanbul ignore next: better safe than sorry */\n      this._beforeError(error);\n    }\n  }\n\n  _onRequest(request) {\n    const {\n      options\n    } = this;\n    const {\n      timeout,\n      url\n    } = options;\n    http_timer_1.default(request);\n    this[kCancelTimeouts] = timed_out_1.default(request, timeout, url);\n    const responseEventName = options.cache ? 'cacheableResponse' : 'response';\n    request.once(responseEventName, response => {\n      void this._onResponse(response);\n    });\n    request.once('error', error => {\n      var _a; // Force clean-up, because some packages (e.g. nock) don't do this.\n\n\n      request.destroy(); // Node.js <= 12.18.2 mistakenly emits the response `end` first.\n\n      (_a = request.res) === null || _a === void 0 ? void 0 : _a.removeAllListeners('end');\n      error = error instanceof timed_out_1.TimeoutError ? new TimeoutError(error, this.timings, this) : new RequestError(error.message, error, this);\n\n      this._beforeError(error);\n    });\n    this[kUnproxyEvents] = proxy_events_1.default(request, this, proxiedRequestEvents);\n    this[kRequest] = request;\n    this.emit('uploadProgress', this.uploadProgress); // Send body\n\n    const body = this[kBody];\n    const currentRequest = this.redirects.length === 0 ? this : request;\n\n    if (is_1.default.nodeStream(body)) {\n      body.pipe(currentRequest);\n      body.once('error', error => {\n        this._beforeError(new UploadError(error, this));\n      });\n    } else {\n      this._unlockWrite();\n\n      if (!is_1.default.undefined(body)) {\n        this._writeRequest(body, undefined, () => {});\n\n        currentRequest.end();\n\n        this._lockWrite();\n      } else if (this._cannotHaveBody || this._noPipe) {\n        currentRequest.end();\n\n        this._lockWrite();\n      }\n    }\n\n    this.emit('request', request);\n  }\n\n  async _createCacheableRequest(url, options) {\n    return new Promise((resolve, reject) => {\n      // TODO: Remove `utils/url-to-options.ts` when `cacheable-request` is fixed\n      Object.assign(options, url_to_options_1.default(url)); // `http-cache-semantics` checks this\n      // TODO: Fix this ignore.\n      // @ts-expect-error\n\n      delete options.url;\n      let request; // This is ugly\n\n      const cacheRequest = cacheableStore.get(options.cache)(options, async response => {\n        // TODO: Fix `cacheable-response`\n        response._readableState.autoDestroy = false;\n\n        if (request) {\n          (await request).emit('cacheableResponse', response);\n        }\n\n        resolve(response);\n      }); // Restore options\n\n      options.url = url;\n      cacheRequest.once('error', reject);\n      cacheRequest.once('request', async requestOrPromise => {\n        request = requestOrPromise;\n        resolve(request);\n      });\n    });\n  }\n\n  async _makeRequest() {\n    var _a, _b, _c, _d, _e;\n\n    const {\n      options\n    } = this;\n    const {\n      headers\n    } = options;\n\n    for (const key in headers) {\n      if (is_1.default.undefined(headers[key])) {\n        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n        delete headers[key];\n      } else if (is_1.default.null_(headers[key])) {\n        throw new TypeError(`Use \\`undefined\\` instead of \\`null\\` to delete the \\`${key}\\` header`);\n      }\n    }\n\n    if (options.decompress && is_1.default.undefined(headers['accept-encoding'])) {\n      headers['accept-encoding'] = supportsBrotli ? 'gzip, deflate, br' : 'gzip, deflate';\n    } // Set cookies\n\n\n    if (options.cookieJar) {\n      const cookieString = await options.cookieJar.getCookieString(options.url.toString());\n\n      if (is_1.default.nonEmptyString(cookieString)) {\n        options.headers.cookie = cookieString;\n      }\n    }\n\n    for (const hook of options.hooks.beforeRequest) {\n      // eslint-disable-next-line no-await-in-loop\n      const result = await hook(options);\n\n      if (!is_1.default.undefined(result)) {\n        // @ts-expect-error Skip the type mismatch to support abstract responses\n        options.request = () => result;\n\n        break;\n      }\n    }\n\n    if (options.body && this[kBody] !== options.body) {\n      this[kBody] = options.body;\n    }\n\n    const {\n      agent,\n      request,\n      timeout,\n      url\n    } = options;\n\n    if (options.dnsCache && !('lookup' in options)) {\n      options.lookup = options.dnsCache.lookup;\n    } // UNIX sockets\n\n\n    if (url.hostname === 'unix') {\n      const matches = /(?<socketPath>.+?):(?<path>.+)/.exec(`${url.pathname}${url.search}`);\n\n      if (matches === null || matches === void 0 ? void 0 : matches.groups) {\n        const {\n          socketPath,\n          path\n        } = matches.groups;\n        Object.assign(options, {\n          socketPath,\n          path,\n          host: ''\n        });\n      }\n    }\n\n    const isHttps = url.protocol === 'https:'; // Fallback function\n\n    let fallbackFn;\n\n    if (options.http2) {\n      fallbackFn = http2wrapper.auto;\n    } else {\n      fallbackFn = isHttps ? https.request : http.request;\n    }\n\n    const realFn = (_a = options.request) !== null && _a !== void 0 ? _a : fallbackFn; // Cache support\n\n    const fn = options.cache ? this._createCacheableRequest : realFn; // Pass an agent directly when HTTP2 is disabled\n\n    if (agent && !options.http2) {\n      options.agent = agent[isHttps ? 'https' : 'http'];\n    } // Prepare plain HTTP request options\n\n\n    options[kRequest] = realFn;\n    delete options.request; // TODO: Fix this ignore.\n    // @ts-expect-error\n\n    delete options.timeout;\n    const requestOptions = options;\n    requestOptions.shared = (_b = options.cacheOptions) === null || _b === void 0 ? void 0 : _b.shared;\n    requestOptions.cacheHeuristic = (_c = options.cacheOptions) === null || _c === void 0 ? void 0 : _c.cacheHeuristic;\n    requestOptions.immutableMinTimeToLive = (_d = options.cacheOptions) === null || _d === void 0 ? void 0 : _d.immutableMinTimeToLive;\n    requestOptions.ignoreCargoCult = (_e = options.cacheOptions) === null || _e === void 0 ? void 0 : _e.ignoreCargoCult; // If `dnsLookupIpVersion` is not present do not override `family`\n\n    if (options.dnsLookupIpVersion !== undefined) {\n      try {\n        requestOptions.family = dns_ip_version_1.dnsLookupIpVersionToFamily(options.dnsLookupIpVersion);\n      } catch (_f) {\n        throw new Error('Invalid `dnsLookupIpVersion` option value');\n      }\n    } // HTTPS options remapping\n\n\n    if (options.https) {\n      if ('rejectUnauthorized' in options.https) {\n        requestOptions.rejectUnauthorized = options.https.rejectUnauthorized;\n      }\n\n      if (options.https.checkServerIdentity) {\n        requestOptions.checkServerIdentity = options.https.checkServerIdentity;\n      }\n\n      if (options.https.certificateAuthority) {\n        requestOptions.ca = options.https.certificateAuthority;\n      }\n\n      if (options.https.certificate) {\n        requestOptions.cert = options.https.certificate;\n      }\n\n      if (options.https.key) {\n        requestOptions.key = options.https.key;\n      }\n\n      if (options.https.passphrase) {\n        requestOptions.passphrase = options.https.passphrase;\n      }\n\n      if (options.https.pfx) {\n        requestOptions.pfx = options.https.pfx;\n      }\n    }\n\n    try {\n      let requestOrResponse = await fn(url, requestOptions);\n\n      if (is_1.default.undefined(requestOrResponse)) {\n        requestOrResponse = fallbackFn(url, requestOptions);\n      } // Restore options\n\n\n      options.request = request;\n      options.timeout = timeout;\n      options.agent = agent; // HTTPS options restore\n\n      if (options.https) {\n        if ('rejectUnauthorized' in options.https) {\n          delete requestOptions.rejectUnauthorized;\n        }\n\n        if (options.https.checkServerIdentity) {\n          // @ts-expect-error - This one will be removed when we remove the alias.\n          delete requestOptions.checkServerIdentity;\n        }\n\n        if (options.https.certificateAuthority) {\n          delete requestOptions.ca;\n        }\n\n        if (options.https.certificate) {\n          delete requestOptions.cert;\n        }\n\n        if (options.https.key) {\n          delete requestOptions.key;\n        }\n\n        if (options.https.passphrase) {\n          delete requestOptions.passphrase;\n        }\n\n        if (options.https.pfx) {\n          delete requestOptions.pfx;\n        }\n      }\n\n      if (isClientRequest(requestOrResponse)) {\n        this._onRequest(requestOrResponse); // Emit the response after the stream has been ended\n\n      } else if (this.writable) {\n        this.once('finish', () => {\n          void this._onResponse(requestOrResponse);\n        });\n\n        this._unlockWrite();\n\n        this.end();\n\n        this._lockWrite();\n      } else {\n        void this._onResponse(requestOrResponse);\n      }\n    } catch (error) {\n      if (error instanceof CacheableRequest.CacheError) {\n        throw new CacheError(error, this);\n      }\n\n      throw new RequestError(error.message, error, this);\n    }\n  }\n\n  async _error(error) {\n    try {\n      for (const hook of this.options.hooks.beforeError) {\n        // eslint-disable-next-line no-await-in-loop\n        error = await hook(error);\n      }\n    } catch (error_) {\n      error = new RequestError(error_.message, error_, this);\n    }\n\n    this.destroy(error);\n  }\n\n  _beforeError(error) {\n    if (this[kStopReading]) {\n      return;\n    }\n\n    const {\n      options\n    } = this;\n    const retryCount = this.retryCount + 1;\n    this[kStopReading] = true;\n\n    if (!(error instanceof RequestError)) {\n      error = new RequestError(error.message, error, this);\n    }\n\n    const typedError = error;\n    const {\n      response\n    } = typedError;\n    void (async () => {\n      if (response && !response.body) {\n        response.setEncoding(this._readableState.encoding);\n\n        try {\n          response.rawBody = await get_buffer_1.default(response);\n          response.body = response.rawBody.toString();\n        } catch (_a) {}\n      }\n\n      if (this.listenerCount('retry') !== 0) {\n        let backoff;\n\n        try {\n          let retryAfter;\n\n          if (response && 'retry-after' in response.headers) {\n            retryAfter = Number(response.headers['retry-after']);\n\n            if (Number.isNaN(retryAfter)) {\n              retryAfter = Date.parse(response.headers['retry-after']) - Date.now();\n\n              if (retryAfter <= 0) {\n                retryAfter = 1;\n              }\n            } else {\n              retryAfter *= 1000;\n            }\n          }\n\n          backoff = await options.retry.calculateDelay({\n            attemptCount: retryCount,\n            retryOptions: options.retry,\n            error: typedError,\n            retryAfter,\n            computedValue: calculate_retry_delay_1.default({\n              attemptCount: retryCount,\n              retryOptions: options.retry,\n              error: typedError,\n              retryAfter,\n              computedValue: 0\n            })\n          });\n        } catch (error_) {\n          void this._error(new RequestError(error_.message, error_, this));\n          return;\n        }\n\n        if (backoff) {\n          const retry = async () => {\n            try {\n              for (const hook of this.options.hooks.beforeRetry) {\n                // eslint-disable-next-line no-await-in-loop\n                await hook(this.options, typedError, retryCount);\n              }\n            } catch (error_) {\n              void this._error(new RequestError(error_.message, error, this));\n              return;\n            } // Something forced us to abort the retry\n\n\n            if (this.destroyed) {\n              return;\n            }\n\n            this.destroy();\n            this.emit('retry', retryCount, error);\n          };\n\n          this[kRetryTimeout] = setTimeout(retry, backoff);\n          return;\n        }\n      }\n\n      void this._error(typedError);\n    })();\n  }\n\n  _read() {\n    this[kTriggerRead] = true;\n    const response = this[kResponse];\n\n    if (response && !this[kStopReading]) {\n      // We cannot put this in the `if` above\n      // because `.read()` also triggers the `end` event\n      if (response.readableLength) {\n        this[kTriggerRead] = false;\n      }\n\n      let data;\n\n      while ((data = response.read()) !== null) {\n        this[kDownloadedSize] += data.length;\n        this[kStartedReading] = true;\n        const progress = this.downloadProgress;\n\n        if (progress.percent < 1) {\n          this.emit('downloadProgress', progress);\n        }\n\n        this.push(data);\n      }\n    }\n  } // Node.js 12 has incorrect types, so the encoding must be a string\n\n\n  _write(chunk, encoding, callback) {\n    const write = () => {\n      this._writeRequest(chunk, encoding, callback);\n    };\n\n    if (this.requestInitialized) {\n      write();\n    } else {\n      this[kJobs].push(write);\n    }\n  }\n\n  _writeRequest(chunk, encoding, callback) {\n    if (this[kRequest].destroyed) {\n      // Probably the `ClientRequest` instance will throw\n      return;\n    }\n\n    this._progressCallbacks.push(() => {\n      this[kUploadedSize] += Buffer.byteLength(chunk, encoding);\n      const progress = this.uploadProgress;\n\n      if (progress.percent < 1) {\n        this.emit('uploadProgress', progress);\n      }\n    }); // TODO: What happens if it's from cache? Then this[kRequest] won't be defined.\n\n\n    this[kRequest].write(chunk, encoding, error => {\n      if (!error && this._progressCallbacks.length > 0) {\n        this._progressCallbacks.shift()();\n      }\n\n      callback(error);\n    });\n  }\n\n  _final(callback) {\n    const endRequest = () => {\n      // FIX: Node.js 10 calls the write callback AFTER the end callback!\n      while (this._progressCallbacks.length !== 0) {\n        this._progressCallbacks.shift()();\n      } // We need to check if `this[kRequest]` is present,\n      // because it isn't when we use cache.\n\n\n      if (!(kRequest in this)) {\n        callback();\n        return;\n      }\n\n      if (this[kRequest].destroyed) {\n        callback();\n        return;\n      }\n\n      this[kRequest].end(error => {\n        if (!error) {\n          this[kBodySize] = this[kUploadedSize];\n          this.emit('uploadProgress', this.uploadProgress);\n          this[kRequest].emit('upload-complete');\n        }\n\n        callback(error);\n      });\n    };\n\n    if (this.requestInitialized) {\n      endRequest();\n    } else {\n      this[kJobs].push(endRequest);\n    }\n  }\n\n  _destroy(error, callback) {\n    var _a;\n\n    this[kStopReading] = true; // Prevent further retries\n\n    clearTimeout(this[kRetryTimeout]);\n\n    if (kRequest in this) {\n      this[kCancelTimeouts](); // TODO: Remove the next `if` when these get fixed:\n      // - https://github.com/nodejs/node/issues/32851\n\n      if (!((_a = this[kResponse]) === null || _a === void 0 ? void 0 : _a.complete)) {\n        this[kRequest].destroy();\n      }\n    }\n\n    if (error !== null && !is_1.default.undefined(error) && !(error instanceof RequestError)) {\n      error = new RequestError(error.message, error, this);\n    }\n\n    callback(error);\n  }\n\n  get _isAboutToError() {\n    return this[kStopReading];\n  }\n  /**\n  The remote IP address.\n  */\n\n\n  get ip() {\n    var _a;\n\n    return (_a = this.socket) === null || _a === void 0 ? void 0 : _a.remoteAddress;\n  }\n  /**\n  Indicates whether the request has been aborted or not.\n  */\n\n\n  get aborted() {\n    var _a, _b, _c;\n\n    return ((_b = (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.destroyed) !== null && _b !== void 0 ? _b : this.destroyed) && !((_c = this[kOriginalResponse]) === null || _c === void 0 ? void 0 : _c.complete);\n  }\n\n  get socket() {\n    var _a, _b;\n\n    return (_b = (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.socket) !== null && _b !== void 0 ? _b : undefined;\n  }\n  /**\n  Progress event for downloading (receiving a response).\n  */\n\n\n  get downloadProgress() {\n    let percent;\n\n    if (this[kResponseSize]) {\n      percent = this[kDownloadedSize] / this[kResponseSize];\n    } else if (this[kResponseSize] === this[kDownloadedSize]) {\n      percent = 1;\n    } else {\n      percent = 0;\n    }\n\n    return {\n      percent,\n      transferred: this[kDownloadedSize],\n      total: this[kResponseSize]\n    };\n  }\n  /**\n  Progress event for uploading (sending a request).\n  */\n\n\n  get uploadProgress() {\n    let percent;\n\n    if (this[kBodySize]) {\n      percent = this[kUploadedSize] / this[kBodySize];\n    } else if (this[kBodySize] === this[kUploadedSize]) {\n      percent = 1;\n    } else {\n      percent = 0;\n    }\n\n    return {\n      percent,\n      transferred: this[kUploadedSize],\n      total: this[kBodySize]\n    };\n  }\n  /**\n  The object contains the following properties:\n   - `start` - Time when the request started.\n  - `socket` - Time when a socket was assigned to the request.\n  - `lookup` - Time when the DNS lookup finished.\n  - `connect` - Time when the socket successfully connected.\n  - `secureConnect` - Time when the socket securely connected.\n  - `upload` - Time when the request finished uploading.\n  - `response` - Time when the request fired `response` event.\n  - `end` - Time when the response fired `end` event.\n  - `error` - Time when the request fired `error` event.\n  - `abort` - Time when the request fired `abort` event.\n  - `phases`\n      - `wait` - `timings.socket - timings.start`\n      - `dns` - `timings.lookup - timings.socket`\n      - `tcp` - `timings.connect - timings.lookup`\n      - `tls` - `timings.secureConnect - timings.connect`\n      - `request` - `timings.upload - (timings.secureConnect || timings.connect)`\n      - `firstByte` - `timings.response - timings.upload`\n      - `download` - `timings.end - timings.response`\n      - `total` - `(timings.end || timings.error || timings.abort) - timings.start`\n   If something has not been measured yet, it will be `undefined`.\n   __Note__: The time is a `number` representing the milliseconds elapsed since the UNIX epoch.\n  */\n\n\n  get timings() {\n    var _a;\n\n    return (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.timings;\n  }\n  /**\n  Whether the response was retrieved from the cache.\n  */\n\n\n  get isFromCache() {\n    return this[kIsFromCache];\n  }\n\n  pipe(destination, options) {\n    if (this[kStartedReading]) {\n      throw new Error('Failed to pipe. The response has been emitted already.');\n    }\n\n    if (destination instanceof http_1.ServerResponse) {\n      this[kServerResponsesPiped].add(destination);\n    }\n\n    return super.pipe(destination, options);\n  }\n\n  unpipe(destination) {\n    if (destination instanceof http_1.ServerResponse) {\n      this[kServerResponsesPiped].delete(destination);\n    }\n\n    super.unpipe(destination);\n    return this;\n  }\n\n}\n\nexports.default = Request;","map":{"version":3,"names":["Object","defineProperty","exports","value","UnsupportedProtocolError","ReadError","TimeoutError","UploadError","CacheError","HTTPError","MaxRedirectsError","RequestError","setNonEnumerableProperties","knownHookEvents","withoutBody","kIsNormalizedAlready","util_1","require","stream_1","fs_1","url_1","http","http_1","https","http_timer_1","cacheable_lookup_1","CacheableRequest","decompressResponse","http2wrapper","lowercaseKeys","is_1","get_body_size_1","is_form_data_1","proxy_events_1","timed_out_1","url_to_options_1","options_to_url_1","weakable_map_1","get_buffer_1","dns_ip_version_1","is_response_ok_1","deprecation_warning_1","normalize_arguments_1","calculate_retry_delay_1","globalDnsCache","kRequest","Symbol","kResponse","kResponseSize","kDownloadedSize","kBodySize","kUploadedSize","kServerResponsesPiped","kUnproxyEvents","kIsFromCache","kCancelTimeouts","kStartedReading","kStopReading","kTriggerRead","kBody","kJobs","kOriginalResponse","kRetryTimeout","supportsBrotli","default","string","process","versions","brotli","Set","validateSearchParameters","searchParameters","key","number","boolean","null_","undefined","TypeError","String","isClientRequest","clientRequest","object","cacheableStore","waitForOpenFile","file","Promise","resolve","reject","onError","error","pending","once","off","redirectCodes","nonEnumerableProperties","sources","to","properties","source","name","writable","configurable","enumerable","defineProperties","Error","constructor","message","self","_a","_b","captureStackTrace","code","Request","options","timings","request","stack","indexOfMessage","indexOf","length","thisStackTrace","slice","split","reverse","errorStackTrace","shift","join","maxRedirects","response","statusCode","statusMessage","event","url","protocol","proxiedRequestEvents","Duplex","defaults","autoDestroy","highWaterMark","requestInitialized","redirects","retryCount","_progressCallbacks","unlockWrite","_unlockWrite","lockWrite","_lockWrite","on","prependListener","IncomingMessage","headers","json","body","form","normalizeArguments","nodeStream","destroy","ReadStream","normalizedURL","requestUrl","toString","decodeURI","_finalizeBody","_makeRequest","destroyed","job","_beforeError","_c","_d","_e","rawOptions","urlInstance","URL","cache","dnsCache","assert","any","method","prefixUrl","cookieJar","searchParams","timeout","context","hooks","decompress","ignoreInvalidCookies","followRedirect","throwHttpErrors","http2","allowGetBody","localAddress","isDnsLookupIpVersion","dnsLookupIpVersion","rejectUnauthorized","function_","checkServerIdentity","array","certificateAuthority","certificate","passphrase","buffer","pfx","cacheOptions","toUpperCase","URLSearchParams","append","forEach","has","username","password","endsWith","startsWith","port","set","href","get","pathname","search","setCookie","getCookieString","promisify","bind","requestOptions","handler","result","promise","catch","lookup","areHooksDefault","defaultHooks","agent","onLockedWrite","write","end","isForm","isJSON","isBody","hasPayload","cannotHaveBody","_cannotHaveBody","filter","isTrue","Readable","noContentType","getBoundary","stringifyJson","uploadBodySize","Number","_onResponseBase","typedResponse","STATUS_CODES","redirectUrls","isFromCache","fromCache","ip","emit","downloadProgress","rawCookies","promises","map","rawCookie","p","all","location","resume","shouldBeGet","methodRewriting","redirectBuffer","Buffer","from","redirectUrl","redirectString","isUnixSocketURL","hostname","host","cookie","authorization","push","hook","beforeRedirect","isStream","isResponseOk","_read","pause","destination","headersSent","isAllowed","setHeader","_onResponse","_onRequest","responseEventName","res","removeAllListeners","uploadProgress","currentRequest","pipe","_writeRequest","_noPipe","_createCacheableRequest","assign","cacheRequest","_readableState","requestOrPromise","cookieString","nonEmptyString","beforeRequest","matches","exec","groups","socketPath","path","isHttps","fallbackFn","auto","realFn","fn","shared","cacheHeuristic","immutableMinTimeToLive","ignoreCargoCult","family","dnsLookupIpVersionToFamily","_f","ca","cert","requestOrResponse","_error","beforeError","error_","typedError","setEncoding","encoding","rawBody","listenerCount","backoff","retryAfter","isNaN","Date","parse","now","retry","calculateDelay","attemptCount","retryOptions","computedValue","beforeRetry","setTimeout","readableLength","data","read","progress","percent","_write","chunk","callback","byteLength","_final","endRequest","_destroy","clearTimeout","complete","_isAboutToError","socket","remoteAddress","aborted","transferred","total","ServerResponse","add","unpipe","delete"],"sources":["C:/Users/hamzu/Desktop/React/React projects/react-store/node_modules/got/dist/source/core/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UnsupportedProtocolError = exports.ReadError = exports.TimeoutError = exports.UploadError = exports.CacheError = exports.HTTPError = exports.MaxRedirectsError = exports.RequestError = exports.setNonEnumerableProperties = exports.knownHookEvents = exports.withoutBody = exports.kIsNormalizedAlready = void 0;\nconst util_1 = require(\"util\");\nconst stream_1 = require(\"stream\");\nconst fs_1 = require(\"fs\");\nconst url_1 = require(\"url\");\nconst http = require(\"http\");\nconst http_1 = require(\"http\");\nconst https = require(\"https\");\nconst http_timer_1 = require(\"@szmarczak/http-timer\");\nconst cacheable_lookup_1 = require(\"cacheable-lookup\");\nconst CacheableRequest = require(\"cacheable-request\");\nconst decompressResponse = require(\"decompress-response\");\n// @ts-expect-error Missing types\nconst http2wrapper = require(\"http2-wrapper\");\nconst lowercaseKeys = require(\"lowercase-keys\");\nconst is_1 = require(\"@sindresorhus/is\");\nconst get_body_size_1 = require(\"./utils/get-body-size\");\nconst is_form_data_1 = require(\"./utils/is-form-data\");\nconst proxy_events_1 = require(\"./utils/proxy-events\");\nconst timed_out_1 = require(\"./utils/timed-out\");\nconst url_to_options_1 = require(\"./utils/url-to-options\");\nconst options_to_url_1 = require(\"./utils/options-to-url\");\nconst weakable_map_1 = require(\"./utils/weakable-map\");\nconst get_buffer_1 = require(\"./utils/get-buffer\");\nconst dns_ip_version_1 = require(\"./utils/dns-ip-version\");\nconst is_response_ok_1 = require(\"./utils/is-response-ok\");\nconst deprecation_warning_1 = require(\"../utils/deprecation-warning\");\nconst normalize_arguments_1 = require(\"../as-promise/normalize-arguments\");\nconst calculate_retry_delay_1 = require(\"./calculate-retry-delay\");\nlet globalDnsCache;\nconst kRequest = Symbol('request');\nconst kResponse = Symbol('response');\nconst kResponseSize = Symbol('responseSize');\nconst kDownloadedSize = Symbol('downloadedSize');\nconst kBodySize = Symbol('bodySize');\nconst kUploadedSize = Symbol('uploadedSize');\nconst kServerResponsesPiped = Symbol('serverResponsesPiped');\nconst kUnproxyEvents = Symbol('unproxyEvents');\nconst kIsFromCache = Symbol('isFromCache');\nconst kCancelTimeouts = Symbol('cancelTimeouts');\nconst kStartedReading = Symbol('startedReading');\nconst kStopReading = Symbol('stopReading');\nconst kTriggerRead = Symbol('triggerRead');\nconst kBody = Symbol('body');\nconst kJobs = Symbol('jobs');\nconst kOriginalResponse = Symbol('originalResponse');\nconst kRetryTimeout = Symbol('retryTimeout');\nexports.kIsNormalizedAlready = Symbol('isNormalizedAlready');\nconst supportsBrotli = is_1.default.string(process.versions.brotli);\nexports.withoutBody = new Set(['GET', 'HEAD']);\nexports.knownHookEvents = [\n    'init',\n    'beforeRequest',\n    'beforeRedirect',\n    'beforeError',\n    'beforeRetry',\n    // Promise-Only\n    'afterResponse'\n];\nfunction validateSearchParameters(searchParameters) {\n    // eslint-disable-next-line guard-for-in\n    for (const key in searchParameters) {\n        const value = searchParameters[key];\n        if (!is_1.default.string(value) && !is_1.default.number(value) && !is_1.default.boolean(value) && !is_1.default.null_(value) && !is_1.default.undefined(value)) {\n            throw new TypeError(`The \\`searchParams\\` value '${String(value)}' must be a string, number, boolean or null`);\n        }\n    }\n}\nfunction isClientRequest(clientRequest) {\n    return is_1.default.object(clientRequest) && !('statusCode' in clientRequest);\n}\nconst cacheableStore = new weakable_map_1.default();\nconst waitForOpenFile = async (file) => new Promise((resolve, reject) => {\n    const onError = (error) => {\n        reject(error);\n    };\n    // Node.js 12 has incomplete types\n    if (!file.pending) {\n        resolve();\n    }\n    file.once('error', onError);\n    file.once('ready', () => {\n        file.off('error', onError);\n        resolve();\n    });\n});\nconst redirectCodes = new Set([300, 301, 302, 303, 304, 307, 308]);\nconst nonEnumerableProperties = [\n    'context',\n    'body',\n    'json',\n    'form'\n];\nexports.setNonEnumerableProperties = (sources, to) => {\n    // Non enumerable properties shall not be merged\n    const properties = {};\n    for (const source of sources) {\n        if (!source) {\n            continue;\n        }\n        for (const name of nonEnumerableProperties) {\n            if (!(name in source)) {\n                continue;\n            }\n            properties[name] = {\n                writable: true,\n                configurable: true,\n                enumerable: false,\n                // @ts-expect-error TS doesn't see the check above\n                value: source[name]\n            };\n        }\n    }\n    Object.defineProperties(to, properties);\n};\n/**\nAn error to be thrown when a request fails.\nContains a `code` property with error class code, like `ECONNREFUSED`.\n*/\nclass RequestError extends Error {\n    constructor(message, error, self) {\n        var _a, _b;\n        super(message);\n        Error.captureStackTrace(this, this.constructor);\n        this.name = 'RequestError';\n        this.code = (_a = error.code) !== null && _a !== void 0 ? _a : 'ERR_GOT_REQUEST_ERROR';\n        if (self instanceof Request) {\n            Object.defineProperty(this, 'request', {\n                enumerable: false,\n                value: self\n            });\n            Object.defineProperty(this, 'response', {\n                enumerable: false,\n                value: self[kResponse]\n            });\n            Object.defineProperty(this, 'options', {\n                // This fails because of TS 3.7.2 useDefineForClassFields\n                // Ref: https://github.com/microsoft/TypeScript/issues/34972\n                enumerable: false,\n                value: self.options\n            });\n        }\n        else {\n            Object.defineProperty(this, 'options', {\n                // This fails because of TS 3.7.2 useDefineForClassFields\n                // Ref: https://github.com/microsoft/TypeScript/issues/34972\n                enumerable: false,\n                value: self\n            });\n        }\n        this.timings = (_b = this.request) === null || _b === void 0 ? void 0 : _b.timings;\n        // Recover the original stacktrace\n        if (is_1.default.string(error.stack) && is_1.default.string(this.stack)) {\n            const indexOfMessage = this.stack.indexOf(this.message) + this.message.length;\n            const thisStackTrace = this.stack.slice(indexOfMessage).split('\\n').reverse();\n            const errorStackTrace = error.stack.slice(error.stack.indexOf(error.message) + error.message.length).split('\\n').reverse();\n            // Remove duplicated traces\n            while (errorStackTrace.length !== 0 && errorStackTrace[0] === thisStackTrace[0]) {\n                thisStackTrace.shift();\n            }\n            this.stack = `${this.stack.slice(0, indexOfMessage)}${thisStackTrace.reverse().join('\\n')}${errorStackTrace.reverse().join('\\n')}`;\n        }\n    }\n}\nexports.RequestError = RequestError;\n/**\nAn error to be thrown when the server redirects you more than ten times.\nIncludes a `response` property.\n*/\nclass MaxRedirectsError extends RequestError {\n    constructor(request) {\n        super(`Redirected ${request.options.maxRedirects} times. Aborting.`, {}, request);\n        this.name = 'MaxRedirectsError';\n        this.code = 'ERR_TOO_MANY_REDIRECTS';\n    }\n}\nexports.MaxRedirectsError = MaxRedirectsError;\n/**\nAn error to be thrown when the server response code is not 2xx nor 3xx if `options.followRedirect` is `true`, but always except for 304.\nIncludes a `response` property.\n*/\nclass HTTPError extends RequestError {\n    constructor(response) {\n        super(`Response code ${response.statusCode} (${response.statusMessage})`, {}, response.request);\n        this.name = 'HTTPError';\n        this.code = 'ERR_NON_2XX_3XX_RESPONSE';\n    }\n}\nexports.HTTPError = HTTPError;\n/**\nAn error to be thrown when a cache method fails.\nFor example, if the database goes down or there's a filesystem error.\n*/\nclass CacheError extends RequestError {\n    constructor(error, request) {\n        super(error.message, error, request);\n        this.name = 'CacheError';\n        this.code = this.code === 'ERR_GOT_REQUEST_ERROR' ? 'ERR_CACHE_ACCESS' : this.code;\n    }\n}\nexports.CacheError = CacheError;\n/**\nAn error to be thrown when the request body is a stream and an error occurs while reading from that stream.\n*/\nclass UploadError extends RequestError {\n    constructor(error, request) {\n        super(error.message, error, request);\n        this.name = 'UploadError';\n        this.code = this.code === 'ERR_GOT_REQUEST_ERROR' ? 'ERR_UPLOAD' : this.code;\n    }\n}\nexports.UploadError = UploadError;\n/**\nAn error to be thrown when the request is aborted due to a timeout.\nIncludes an `event` and `timings` property.\n*/\nclass TimeoutError extends RequestError {\n    constructor(error, timings, request) {\n        super(error.message, error, request);\n        this.name = 'TimeoutError';\n        this.event = error.event;\n        this.timings = timings;\n    }\n}\nexports.TimeoutError = TimeoutError;\n/**\nAn error to be thrown when reading from response stream fails.\n*/\nclass ReadError extends RequestError {\n    constructor(error, request) {\n        super(error.message, error, request);\n        this.name = 'ReadError';\n        this.code = this.code === 'ERR_GOT_REQUEST_ERROR' ? 'ERR_READING_RESPONSE_STREAM' : this.code;\n    }\n}\nexports.ReadError = ReadError;\n/**\nAn error to be thrown when given an unsupported protocol.\n*/\nclass UnsupportedProtocolError extends RequestError {\n    constructor(options) {\n        super(`Unsupported protocol \"${options.url.protocol}\"`, {}, options);\n        this.name = 'UnsupportedProtocolError';\n        this.code = 'ERR_UNSUPPORTED_PROTOCOL';\n    }\n}\nexports.UnsupportedProtocolError = UnsupportedProtocolError;\nconst proxiedRequestEvents = [\n    'socket',\n    'connect',\n    'continue',\n    'information',\n    'upgrade',\n    'timeout'\n];\nclass Request extends stream_1.Duplex {\n    constructor(url, options = {}, defaults) {\n        super({\n            // This must be false, to enable throwing after destroy\n            // It is used for retry logic in Promise API\n            autoDestroy: false,\n            // It needs to be zero because we're just proxying the data to another stream\n            highWaterMark: 0\n        });\n        this[kDownloadedSize] = 0;\n        this[kUploadedSize] = 0;\n        this.requestInitialized = false;\n        this[kServerResponsesPiped] = new Set();\n        this.redirects = [];\n        this[kStopReading] = false;\n        this[kTriggerRead] = false;\n        this[kJobs] = [];\n        this.retryCount = 0;\n        // TODO: Remove this when targeting Node.js >= 12\n        this._progressCallbacks = [];\n        const unlockWrite = () => this._unlockWrite();\n        const lockWrite = () => this._lockWrite();\n        this.on('pipe', (source) => {\n            source.prependListener('data', unlockWrite);\n            source.on('data', lockWrite);\n            source.prependListener('end', unlockWrite);\n            source.on('end', lockWrite);\n        });\n        this.on('unpipe', (source) => {\n            source.off('data', unlockWrite);\n            source.off('data', lockWrite);\n            source.off('end', unlockWrite);\n            source.off('end', lockWrite);\n        });\n        this.on('pipe', source => {\n            if (source instanceof http_1.IncomingMessage) {\n                this.options.headers = {\n                    ...source.headers,\n                    ...this.options.headers\n                };\n            }\n        });\n        const { json, body, form } = options;\n        if (json || body || form) {\n            this._lockWrite();\n        }\n        if (exports.kIsNormalizedAlready in options) {\n            this.options = options;\n        }\n        else {\n            try {\n                // @ts-expect-error Common TypeScript bug saying that `this.constructor` is not accessible\n                this.options = this.constructor.normalizeArguments(url, options, defaults);\n            }\n            catch (error) {\n                // TODO: Move this to `_destroy()`\n                if (is_1.default.nodeStream(options.body)) {\n                    options.body.destroy();\n                }\n                this.destroy(error);\n                return;\n            }\n        }\n        (async () => {\n            var _a;\n            try {\n                if (this.options.body instanceof fs_1.ReadStream) {\n                    await waitForOpenFile(this.options.body);\n                }\n                const { url: normalizedURL } = this.options;\n                if (!normalizedURL) {\n                    throw new TypeError('Missing `url` property');\n                }\n                this.requestUrl = normalizedURL.toString();\n                decodeURI(this.requestUrl);\n                await this._finalizeBody();\n                await this._makeRequest();\n                if (this.destroyed) {\n                    (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.destroy();\n                    return;\n                }\n                // Queued writes etc.\n                for (const job of this[kJobs]) {\n                    job();\n                }\n                // Prevent memory leak\n                this[kJobs].length = 0;\n                this.requestInitialized = true;\n            }\n            catch (error) {\n                if (error instanceof RequestError) {\n                    this._beforeError(error);\n                    return;\n                }\n                // This is a workaround for https://github.com/nodejs/node/issues/33335\n                if (!this.destroyed) {\n                    this.destroy(error);\n                }\n            }\n        })();\n    }\n    static normalizeArguments(url, options, defaults) {\n        var _a, _b, _c, _d, _e;\n        const rawOptions = options;\n        if (is_1.default.object(url) && !is_1.default.urlInstance(url)) {\n            options = { ...defaults, ...url, ...options };\n        }\n        else {\n            if (url && options && options.url !== undefined) {\n                throw new TypeError('The `url` option is mutually exclusive with the `input` argument');\n            }\n            options = { ...defaults, ...options };\n            if (url !== undefined) {\n                options.url = url;\n            }\n            if (is_1.default.urlInstance(options.url)) {\n                options.url = new url_1.URL(options.url.toString());\n            }\n        }\n        // TODO: Deprecate URL options in Got 12.\n        // Support extend-specific options\n        if (options.cache === false) {\n            options.cache = undefined;\n        }\n        if (options.dnsCache === false) {\n            options.dnsCache = undefined;\n        }\n        // Nice type assertions\n        is_1.assert.any([is_1.default.string, is_1.default.undefined], options.method);\n        is_1.assert.any([is_1.default.object, is_1.default.undefined], options.headers);\n        is_1.assert.any([is_1.default.string, is_1.default.urlInstance, is_1.default.undefined], options.prefixUrl);\n        is_1.assert.any([is_1.default.object, is_1.default.undefined], options.cookieJar);\n        is_1.assert.any([is_1.default.object, is_1.default.string, is_1.default.undefined], options.searchParams);\n        is_1.assert.any([is_1.default.object, is_1.default.string, is_1.default.undefined], options.cache);\n        is_1.assert.any([is_1.default.object, is_1.default.number, is_1.default.undefined], options.timeout);\n        is_1.assert.any([is_1.default.object, is_1.default.undefined], options.context);\n        is_1.assert.any([is_1.default.object, is_1.default.undefined], options.hooks);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.decompress);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.ignoreInvalidCookies);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.followRedirect);\n        is_1.assert.any([is_1.default.number, is_1.default.undefined], options.maxRedirects);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.throwHttpErrors);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.http2);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.allowGetBody);\n        is_1.assert.any([is_1.default.string, is_1.default.undefined], options.localAddress);\n        is_1.assert.any([dns_ip_version_1.isDnsLookupIpVersion, is_1.default.undefined], options.dnsLookupIpVersion);\n        is_1.assert.any([is_1.default.object, is_1.default.undefined], options.https);\n        is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.rejectUnauthorized);\n        if (options.https) {\n            is_1.assert.any([is_1.default.boolean, is_1.default.undefined], options.https.rejectUnauthorized);\n            is_1.assert.any([is_1.default.function_, is_1.default.undefined], options.https.checkServerIdentity);\n            is_1.assert.any([is_1.default.string, is_1.default.object, is_1.default.array, is_1.default.undefined], options.https.certificateAuthority);\n            is_1.assert.any([is_1.default.string, is_1.default.object, is_1.default.array, is_1.default.undefined], options.https.key);\n            is_1.assert.any([is_1.default.string, is_1.default.object, is_1.default.array, is_1.default.undefined], options.https.certificate);\n            is_1.assert.any([is_1.default.string, is_1.default.undefined], options.https.passphrase);\n            is_1.assert.any([is_1.default.string, is_1.default.buffer, is_1.default.array, is_1.default.undefined], options.https.pfx);\n        }\n        is_1.assert.any([is_1.default.object, is_1.default.undefined], options.cacheOptions);\n        // `options.method`\n        if (is_1.default.string(options.method)) {\n            options.method = options.method.toUpperCase();\n        }\n        else {\n            options.method = 'GET';\n        }\n        // `options.headers`\n        if (options.headers === (defaults === null || defaults === void 0 ? void 0 : defaults.headers)) {\n            options.headers = { ...options.headers };\n        }\n        else {\n            options.headers = lowercaseKeys({ ...(defaults === null || defaults === void 0 ? void 0 : defaults.headers), ...options.headers });\n        }\n        // Disallow legacy `url.Url`\n        if ('slashes' in options) {\n            throw new TypeError('The legacy `url.Url` has been deprecated. Use `URL` instead.');\n        }\n        // `options.auth`\n        if ('auth' in options) {\n            throw new TypeError('Parameter `auth` is deprecated. Use `username` / `password` instead.');\n        }\n        // `options.searchParams`\n        if ('searchParams' in options) {\n            if (options.searchParams && options.searchParams !== (defaults === null || defaults === void 0 ? void 0 : defaults.searchParams)) {\n                let searchParameters;\n                if (is_1.default.string(options.searchParams) || (options.searchParams instanceof url_1.URLSearchParams)) {\n                    searchParameters = new url_1.URLSearchParams(options.searchParams);\n                }\n                else {\n                    validateSearchParameters(options.searchParams);\n                    searchParameters = new url_1.URLSearchParams();\n                    // eslint-disable-next-line guard-for-in\n                    for (const key in options.searchParams) {\n                        const value = options.searchParams[key];\n                        if (value === null) {\n                            searchParameters.append(key, '');\n                        }\n                        else if (value !== undefined) {\n                            searchParameters.append(key, value);\n                        }\n                    }\n                }\n                // `normalizeArguments()` is also used to merge options\n                (_a = defaults === null || defaults === void 0 ? void 0 : defaults.searchParams) === null || _a === void 0 ? void 0 : _a.forEach((value, key) => {\n                    // Only use default if one isn't already defined\n                    if (!searchParameters.has(key)) {\n                        searchParameters.append(key, value);\n                    }\n                });\n                options.searchParams = searchParameters;\n            }\n        }\n        // `options.username` & `options.password`\n        options.username = (_b = options.username) !== null && _b !== void 0 ? _b : '';\n        options.password = (_c = options.password) !== null && _c !== void 0 ? _c : '';\n        // `options.prefixUrl` & `options.url`\n        if (is_1.default.undefined(options.prefixUrl)) {\n            options.prefixUrl = (_d = defaults === null || defaults === void 0 ? void 0 : defaults.prefixUrl) !== null && _d !== void 0 ? _d : '';\n        }\n        else {\n            options.prefixUrl = options.prefixUrl.toString();\n            if (options.prefixUrl !== '' && !options.prefixUrl.endsWith('/')) {\n                options.prefixUrl += '/';\n            }\n        }\n        if (is_1.default.string(options.url)) {\n            if (options.url.startsWith('/')) {\n                throw new Error('`input` must not start with a slash when using `prefixUrl`');\n            }\n            options.url = options_to_url_1.default(options.prefixUrl + options.url, options);\n        }\n        else if ((is_1.default.undefined(options.url) && options.prefixUrl !== '') || options.protocol) {\n            options.url = options_to_url_1.default(options.prefixUrl, options);\n        }\n        if (options.url) {\n            if ('port' in options) {\n                delete options.port;\n            }\n            // Make it possible to change `options.prefixUrl`\n            let { prefixUrl } = options;\n            Object.defineProperty(options, 'prefixUrl', {\n                set: (value) => {\n                    const url = options.url;\n                    if (!url.href.startsWith(value)) {\n                        throw new Error(`Cannot change \\`prefixUrl\\` from ${prefixUrl} to ${value}: ${url.href}`);\n                    }\n                    options.url = new url_1.URL(value + url.href.slice(prefixUrl.length));\n                    prefixUrl = value;\n                },\n                get: () => prefixUrl\n            });\n            // Support UNIX sockets\n            let { protocol } = options.url;\n            if (protocol === 'unix:') {\n                protocol = 'http:';\n                options.url = new url_1.URL(`http://unix${options.url.pathname}${options.url.search}`);\n            }\n            // Set search params\n            if (options.searchParams) {\n                // eslint-disable-next-line @typescript-eslint/no-base-to-string\n                options.url.search = options.searchParams.toString();\n            }\n            // Protocol check\n            if (protocol !== 'http:' && protocol !== 'https:') {\n                throw new UnsupportedProtocolError(options);\n            }\n            // Update `username`\n            if (options.username === '') {\n                options.username = options.url.username;\n            }\n            else {\n                options.url.username = options.username;\n            }\n            // Update `password`\n            if (options.password === '') {\n                options.password = options.url.password;\n            }\n            else {\n                options.url.password = options.password;\n            }\n        }\n        // `options.cookieJar`\n        const { cookieJar } = options;\n        if (cookieJar) {\n            let { setCookie, getCookieString } = cookieJar;\n            is_1.assert.function_(setCookie);\n            is_1.assert.function_(getCookieString);\n            /* istanbul ignore next: Horrible `tough-cookie` v3 check */\n            if (setCookie.length === 4 && getCookieString.length === 0) {\n                setCookie = util_1.promisify(setCookie.bind(options.cookieJar));\n                getCookieString = util_1.promisify(getCookieString.bind(options.cookieJar));\n                options.cookieJar = {\n                    setCookie,\n                    getCookieString: getCookieString\n                };\n            }\n        }\n        // `options.cache`\n        const { cache } = options;\n        if (cache) {\n            if (!cacheableStore.has(cache)) {\n                cacheableStore.set(cache, new CacheableRequest(((requestOptions, handler) => {\n                    const result = requestOptions[kRequest](requestOptions, handler);\n                    // TODO: remove this when `cacheable-request` supports async request functions.\n                    if (is_1.default.promise(result)) {\n                        // @ts-expect-error\n                        // We only need to implement the error handler in order to support HTTP2 caching.\n                        // The result will be a promise anyway.\n                        result.once = (event, handler) => {\n                            if (event === 'error') {\n                                result.catch(handler);\n                            }\n                            else if (event === 'abort') {\n                                // The empty catch is needed here in case when\n                                // it rejects before it's `await`ed in `_makeRequest`.\n                                (async () => {\n                                    try {\n                                        const request = (await result);\n                                        request.once('abort', handler);\n                                    }\n                                    catch (_a) { }\n                                })();\n                            }\n                            else {\n                                /* istanbul ignore next: safety check */\n                                throw new Error(`Unknown HTTP2 promise event: ${event}`);\n                            }\n                            return result;\n                        };\n                    }\n                    return result;\n                }), cache));\n            }\n        }\n        // `options.cacheOptions`\n        options.cacheOptions = { ...options.cacheOptions };\n        // `options.dnsCache`\n        if (options.dnsCache === true) {\n            if (!globalDnsCache) {\n                globalDnsCache = new cacheable_lookup_1.default();\n            }\n            options.dnsCache = globalDnsCache;\n        }\n        else if (!is_1.default.undefined(options.dnsCache) && !options.dnsCache.lookup) {\n            throw new TypeError(`Parameter \\`dnsCache\\` must be a CacheableLookup instance or a boolean, got ${is_1.default(options.dnsCache)}`);\n        }\n        // `options.timeout`\n        if (is_1.default.number(options.timeout)) {\n            options.timeout = { request: options.timeout };\n        }\n        else if (defaults && options.timeout !== defaults.timeout) {\n            options.timeout = {\n                ...defaults.timeout,\n                ...options.timeout\n            };\n        }\n        else {\n            options.timeout = { ...options.timeout };\n        }\n        // `options.context`\n        if (!options.context) {\n            options.context = {};\n        }\n        // `options.hooks`\n        const areHooksDefault = options.hooks === (defaults === null || defaults === void 0 ? void 0 : defaults.hooks);\n        options.hooks = { ...options.hooks };\n        for (const event of exports.knownHookEvents) {\n            if (event in options.hooks) {\n                if (is_1.default.array(options.hooks[event])) {\n                    // See https://github.com/microsoft/TypeScript/issues/31445#issuecomment-576929044\n                    options.hooks[event] = [...options.hooks[event]];\n                }\n                else {\n                    throw new TypeError(`Parameter \\`${event}\\` must be an Array, got ${is_1.default(options.hooks[event])}`);\n                }\n            }\n            else {\n                options.hooks[event] = [];\n            }\n        }\n        if (defaults && !areHooksDefault) {\n            for (const event of exports.knownHookEvents) {\n                const defaultHooks = defaults.hooks[event];\n                if (defaultHooks.length > 0) {\n                    // See https://github.com/microsoft/TypeScript/issues/31445#issuecomment-576929044\n                    options.hooks[event] = [\n                        ...defaults.hooks[event],\n                        ...options.hooks[event]\n                    ];\n                }\n            }\n        }\n        // DNS options\n        if ('family' in options) {\n            deprecation_warning_1.default('\"options.family\" was never documented, please use \"options.dnsLookupIpVersion\"');\n        }\n        // HTTPS options\n        if (defaults === null || defaults === void 0 ? void 0 : defaults.https) {\n            options.https = { ...defaults.https, ...options.https };\n        }\n        if ('rejectUnauthorized' in options) {\n            deprecation_warning_1.default('\"options.rejectUnauthorized\" is now deprecated, please use \"options.https.rejectUnauthorized\"');\n        }\n        if ('checkServerIdentity' in options) {\n            deprecation_warning_1.default('\"options.checkServerIdentity\" was never documented, please use \"options.https.checkServerIdentity\"');\n        }\n        if ('ca' in options) {\n            deprecation_warning_1.default('\"options.ca\" was never documented, please use \"options.https.certificateAuthority\"');\n        }\n        if ('key' in options) {\n            deprecation_warning_1.default('\"options.key\" was never documented, please use \"options.https.key\"');\n        }\n        if ('cert' in options) {\n            deprecation_warning_1.default('\"options.cert\" was never documented, please use \"options.https.certificate\"');\n        }\n        if ('passphrase' in options) {\n            deprecation_warning_1.default('\"options.passphrase\" was never documented, please use \"options.https.passphrase\"');\n        }\n        if ('pfx' in options) {\n            deprecation_warning_1.default('\"options.pfx\" was never documented, please use \"options.https.pfx\"');\n        }\n        // Other options\n        if ('followRedirects' in options) {\n            throw new TypeError('The `followRedirects` option does not exist. Use `followRedirect` instead.');\n        }\n        if (options.agent) {\n            for (const key in options.agent) {\n                if (key !== 'http' && key !== 'https' && key !== 'http2') {\n                    throw new TypeError(`Expected the \\`options.agent\\` properties to be \\`http\\`, \\`https\\` or \\`http2\\`, got \\`${key}\\``);\n                }\n            }\n        }\n        options.maxRedirects = (_e = options.maxRedirects) !== null && _e !== void 0 ? _e : 0;\n        // Set non-enumerable properties\n        exports.setNonEnumerableProperties([defaults, rawOptions], options);\n        return normalize_arguments_1.default(options, defaults);\n    }\n    _lockWrite() {\n        const onLockedWrite = () => {\n            throw new TypeError('The payload has been already provided');\n        };\n        this.write = onLockedWrite;\n        this.end = onLockedWrite;\n    }\n    _unlockWrite() {\n        this.write = super.write;\n        this.end = super.end;\n    }\n    async _finalizeBody() {\n        const { options } = this;\n        const { headers } = options;\n        const isForm = !is_1.default.undefined(options.form);\n        const isJSON = !is_1.default.undefined(options.json);\n        const isBody = !is_1.default.undefined(options.body);\n        const hasPayload = isForm || isJSON || isBody;\n        const cannotHaveBody = exports.withoutBody.has(options.method) && !(options.method === 'GET' && options.allowGetBody);\n        this._cannotHaveBody = cannotHaveBody;\n        if (hasPayload) {\n            if (cannotHaveBody) {\n                throw new TypeError(`The \\`${options.method}\\` method cannot be used with a body`);\n            }\n            if ([isBody, isForm, isJSON].filter(isTrue => isTrue).length > 1) {\n                throw new TypeError('The `body`, `json` and `form` options are mutually exclusive');\n            }\n            if (isBody &&\n                !(options.body instanceof stream_1.Readable) &&\n                !is_1.default.string(options.body) &&\n                !is_1.default.buffer(options.body) &&\n                !is_form_data_1.default(options.body)) {\n                throw new TypeError('The `body` option must be a stream.Readable, string or Buffer');\n            }\n            if (isForm && !is_1.default.object(options.form)) {\n                throw new TypeError('The `form` option must be an Object');\n            }\n            {\n                // Serialize body\n                const noContentType = !is_1.default.string(headers['content-type']);\n                if (isBody) {\n                    // Special case for https://github.com/form-data/form-data\n                    if (is_form_data_1.default(options.body) && noContentType) {\n                        headers['content-type'] = `multipart/form-data; boundary=${options.body.getBoundary()}`;\n                    }\n                    this[kBody] = options.body;\n                }\n                else if (isForm) {\n                    if (noContentType) {\n                        headers['content-type'] = 'application/x-www-form-urlencoded';\n                    }\n                    this[kBody] = (new url_1.URLSearchParams(options.form)).toString();\n                }\n                else {\n                    if (noContentType) {\n                        headers['content-type'] = 'application/json';\n                    }\n                    this[kBody] = options.stringifyJson(options.json);\n                }\n                const uploadBodySize = await get_body_size_1.default(this[kBody], options.headers);\n                // See https://tools.ietf.org/html/rfc7230#section-3.3.2\n                // A user agent SHOULD send a Content-Length in a request message when\n                // no Transfer-Encoding is sent and the request method defines a meaning\n                // for an enclosed payload body.  For example, a Content-Length header\n                // field is normally sent in a POST request even when the value is 0\n                // (indicating an empty payload body).  A user agent SHOULD NOT send a\n                // Content-Length header field when the request message does not contain\n                // a payload body and the method semantics do not anticipate such a\n                // body.\n                if (is_1.default.undefined(headers['content-length']) && is_1.default.undefined(headers['transfer-encoding'])) {\n                    if (!cannotHaveBody && !is_1.default.undefined(uploadBodySize)) {\n                        headers['content-length'] = String(uploadBodySize);\n                    }\n                }\n            }\n        }\n        else if (cannotHaveBody) {\n            this._lockWrite();\n        }\n        else {\n            this._unlockWrite();\n        }\n        this[kBodySize] = Number(headers['content-length']) || undefined;\n    }\n    async _onResponseBase(response) {\n        const { options } = this;\n        const { url } = options;\n        this[kOriginalResponse] = response;\n        if (options.decompress) {\n            response = decompressResponse(response);\n        }\n        const statusCode = response.statusCode;\n        const typedResponse = response;\n        typedResponse.statusMessage = typedResponse.statusMessage ? typedResponse.statusMessage : http.STATUS_CODES[statusCode];\n        typedResponse.url = options.url.toString();\n        typedResponse.requestUrl = this.requestUrl;\n        typedResponse.redirectUrls = this.redirects;\n        typedResponse.request = this;\n        typedResponse.isFromCache = response.fromCache || false;\n        typedResponse.ip = this.ip;\n        typedResponse.retryCount = this.retryCount;\n        this[kIsFromCache] = typedResponse.isFromCache;\n        this[kResponseSize] = Number(response.headers['content-length']) || undefined;\n        this[kResponse] = response;\n        response.once('end', () => {\n            this[kResponseSize] = this[kDownloadedSize];\n            this.emit('downloadProgress', this.downloadProgress);\n        });\n        response.once('error', (error) => {\n            // Force clean-up, because some packages don't do this.\n            // TODO: Fix decompress-response\n            response.destroy();\n            this._beforeError(new ReadError(error, this));\n        });\n        response.once('aborted', () => {\n            this._beforeError(new ReadError({\n                name: 'Error',\n                message: 'The server aborted pending request',\n                code: 'ECONNRESET'\n            }, this));\n        });\n        this.emit('downloadProgress', this.downloadProgress);\n        const rawCookies = response.headers['set-cookie'];\n        if (is_1.default.object(options.cookieJar) && rawCookies) {\n            let promises = rawCookies.map(async (rawCookie) => options.cookieJar.setCookie(rawCookie, url.toString()));\n            if (options.ignoreInvalidCookies) {\n                promises = promises.map(async (p) => p.catch(() => { }));\n            }\n            try {\n                await Promise.all(promises);\n            }\n            catch (error) {\n                this._beforeError(error);\n                return;\n            }\n        }\n        if (options.followRedirect && response.headers.location && redirectCodes.has(statusCode)) {\n            // We're being redirected, we don't care about the response.\n            // It'd be best to abort the request, but we can't because\n            // we would have to sacrifice the TCP connection. We don't want that.\n            response.resume();\n            if (this[kRequest]) {\n                this[kCancelTimeouts]();\n                // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n                delete this[kRequest];\n                this[kUnproxyEvents]();\n            }\n            const shouldBeGet = statusCode === 303 && options.method !== 'GET' && options.method !== 'HEAD';\n            if (shouldBeGet || !options.methodRewriting) {\n                // Server responded with \"see other\", indicating that the resource exists at another location,\n                // and the client should request it from that location via GET or HEAD.\n                options.method = 'GET';\n                if ('body' in options) {\n                    delete options.body;\n                }\n                if ('json' in options) {\n                    delete options.json;\n                }\n                if ('form' in options) {\n                    delete options.form;\n                }\n                this[kBody] = undefined;\n                delete options.headers['content-length'];\n            }\n            if (this.redirects.length >= options.maxRedirects) {\n                this._beforeError(new MaxRedirectsError(this));\n                return;\n            }\n            try {\n                // Do not remove. See https://github.com/sindresorhus/got/pull/214\n                const redirectBuffer = Buffer.from(response.headers.location, 'binary').toString();\n                // Handles invalid URLs. See https://github.com/sindresorhus/got/issues/604\n                const redirectUrl = new url_1.URL(redirectBuffer, url);\n                const redirectString = redirectUrl.toString();\n                decodeURI(redirectString);\n                // eslint-disable-next-line no-inner-declarations\n                function isUnixSocketURL(url) {\n                    return url.protocol === 'unix:' || url.hostname === 'unix';\n                }\n                if (!isUnixSocketURL(url) && isUnixSocketURL(redirectUrl)) {\n                    this._beforeError(new RequestError('Cannot redirect to UNIX socket', {}, this));\n                    return;\n                }\n                // Redirecting to a different site, clear sensitive data.\n                if (redirectUrl.hostname !== url.hostname || redirectUrl.port !== url.port) {\n                    if ('host' in options.headers) {\n                        delete options.headers.host;\n                    }\n                    if ('cookie' in options.headers) {\n                        delete options.headers.cookie;\n                    }\n                    if ('authorization' in options.headers) {\n                        delete options.headers.authorization;\n                    }\n                    if (options.username || options.password) {\n                        options.username = '';\n                        options.password = '';\n                    }\n                }\n                else {\n                    redirectUrl.username = options.username;\n                    redirectUrl.password = options.password;\n                }\n                this.redirects.push(redirectString);\n                options.url = redirectUrl;\n                for (const hook of options.hooks.beforeRedirect) {\n                    // eslint-disable-next-line no-await-in-loop\n                    await hook(options, typedResponse);\n                }\n                this.emit('redirect', typedResponse, options);\n                await this._makeRequest();\n            }\n            catch (error) {\n                this._beforeError(error);\n                return;\n            }\n            return;\n        }\n        if (options.isStream && options.throwHttpErrors && !is_response_ok_1.isResponseOk(typedResponse)) {\n            this._beforeError(new HTTPError(typedResponse));\n            return;\n        }\n        response.on('readable', () => {\n            if (this[kTriggerRead]) {\n                this._read();\n            }\n        });\n        this.on('resume', () => {\n            response.resume();\n        });\n        this.on('pause', () => {\n            response.pause();\n        });\n        response.once('end', () => {\n            this.push(null);\n        });\n        this.emit('response', response);\n        for (const destination of this[kServerResponsesPiped]) {\n            if (destination.headersSent) {\n                continue;\n            }\n            // eslint-disable-next-line guard-for-in\n            for (const key in response.headers) {\n                const isAllowed = options.decompress ? key !== 'content-encoding' : true;\n                const value = response.headers[key];\n                if (isAllowed) {\n                    destination.setHeader(key, value);\n                }\n            }\n            destination.statusCode = statusCode;\n        }\n    }\n    async _onResponse(response) {\n        try {\n            await this._onResponseBase(response);\n        }\n        catch (error) {\n            /* istanbul ignore next: better safe than sorry */\n            this._beforeError(error);\n        }\n    }\n    _onRequest(request) {\n        const { options } = this;\n        const { timeout, url } = options;\n        http_timer_1.default(request);\n        this[kCancelTimeouts] = timed_out_1.default(request, timeout, url);\n        const responseEventName = options.cache ? 'cacheableResponse' : 'response';\n        request.once(responseEventName, (response) => {\n            void this._onResponse(response);\n        });\n        request.once('error', (error) => {\n            var _a;\n            // Force clean-up, because some packages (e.g. nock) don't do this.\n            request.destroy();\n            // Node.js <= 12.18.2 mistakenly emits the response `end` first.\n            (_a = request.res) === null || _a === void 0 ? void 0 : _a.removeAllListeners('end');\n            error = error instanceof timed_out_1.TimeoutError ? new TimeoutError(error, this.timings, this) : new RequestError(error.message, error, this);\n            this._beforeError(error);\n        });\n        this[kUnproxyEvents] = proxy_events_1.default(request, this, proxiedRequestEvents);\n        this[kRequest] = request;\n        this.emit('uploadProgress', this.uploadProgress);\n        // Send body\n        const body = this[kBody];\n        const currentRequest = this.redirects.length === 0 ? this : request;\n        if (is_1.default.nodeStream(body)) {\n            body.pipe(currentRequest);\n            body.once('error', (error) => {\n                this._beforeError(new UploadError(error, this));\n            });\n        }\n        else {\n            this._unlockWrite();\n            if (!is_1.default.undefined(body)) {\n                this._writeRequest(body, undefined, () => { });\n                currentRequest.end();\n                this._lockWrite();\n            }\n            else if (this._cannotHaveBody || this._noPipe) {\n                currentRequest.end();\n                this._lockWrite();\n            }\n        }\n        this.emit('request', request);\n    }\n    async _createCacheableRequest(url, options) {\n        return new Promise((resolve, reject) => {\n            // TODO: Remove `utils/url-to-options.ts` when `cacheable-request` is fixed\n            Object.assign(options, url_to_options_1.default(url));\n            // `http-cache-semantics` checks this\n            // TODO: Fix this ignore.\n            // @ts-expect-error\n            delete options.url;\n            let request;\n            // This is ugly\n            const cacheRequest = cacheableStore.get(options.cache)(options, async (response) => {\n                // TODO: Fix `cacheable-response`\n                response._readableState.autoDestroy = false;\n                if (request) {\n                    (await request).emit('cacheableResponse', response);\n                }\n                resolve(response);\n            });\n            // Restore options\n            options.url = url;\n            cacheRequest.once('error', reject);\n            cacheRequest.once('request', async (requestOrPromise) => {\n                request = requestOrPromise;\n                resolve(request);\n            });\n        });\n    }\n    async _makeRequest() {\n        var _a, _b, _c, _d, _e;\n        const { options } = this;\n        const { headers } = options;\n        for (const key in headers) {\n            if (is_1.default.undefined(headers[key])) {\n                // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n                delete headers[key];\n            }\n            else if (is_1.default.null_(headers[key])) {\n                throw new TypeError(`Use \\`undefined\\` instead of \\`null\\` to delete the \\`${key}\\` header`);\n            }\n        }\n        if (options.decompress && is_1.default.undefined(headers['accept-encoding'])) {\n            headers['accept-encoding'] = supportsBrotli ? 'gzip, deflate, br' : 'gzip, deflate';\n        }\n        // Set cookies\n        if (options.cookieJar) {\n            const cookieString = await options.cookieJar.getCookieString(options.url.toString());\n            if (is_1.default.nonEmptyString(cookieString)) {\n                options.headers.cookie = cookieString;\n            }\n        }\n        for (const hook of options.hooks.beforeRequest) {\n            // eslint-disable-next-line no-await-in-loop\n            const result = await hook(options);\n            if (!is_1.default.undefined(result)) {\n                // @ts-expect-error Skip the type mismatch to support abstract responses\n                options.request = () => result;\n                break;\n            }\n        }\n        if (options.body && this[kBody] !== options.body) {\n            this[kBody] = options.body;\n        }\n        const { agent, request, timeout, url } = options;\n        if (options.dnsCache && !('lookup' in options)) {\n            options.lookup = options.dnsCache.lookup;\n        }\n        // UNIX sockets\n        if (url.hostname === 'unix') {\n            const matches = /(?<socketPath>.+?):(?<path>.+)/.exec(`${url.pathname}${url.search}`);\n            if (matches === null || matches === void 0 ? void 0 : matches.groups) {\n                const { socketPath, path } = matches.groups;\n                Object.assign(options, {\n                    socketPath,\n                    path,\n                    host: ''\n                });\n            }\n        }\n        const isHttps = url.protocol === 'https:';\n        // Fallback function\n        let fallbackFn;\n        if (options.http2) {\n            fallbackFn = http2wrapper.auto;\n        }\n        else {\n            fallbackFn = isHttps ? https.request : http.request;\n        }\n        const realFn = (_a = options.request) !== null && _a !== void 0 ? _a : fallbackFn;\n        // Cache support\n        const fn = options.cache ? this._createCacheableRequest : realFn;\n        // Pass an agent directly when HTTP2 is disabled\n        if (agent && !options.http2) {\n            options.agent = agent[isHttps ? 'https' : 'http'];\n        }\n        // Prepare plain HTTP request options\n        options[kRequest] = realFn;\n        delete options.request;\n        // TODO: Fix this ignore.\n        // @ts-expect-error\n        delete options.timeout;\n        const requestOptions = options;\n        requestOptions.shared = (_b = options.cacheOptions) === null || _b === void 0 ? void 0 : _b.shared;\n        requestOptions.cacheHeuristic = (_c = options.cacheOptions) === null || _c === void 0 ? void 0 : _c.cacheHeuristic;\n        requestOptions.immutableMinTimeToLive = (_d = options.cacheOptions) === null || _d === void 0 ? void 0 : _d.immutableMinTimeToLive;\n        requestOptions.ignoreCargoCult = (_e = options.cacheOptions) === null || _e === void 0 ? void 0 : _e.ignoreCargoCult;\n        // If `dnsLookupIpVersion` is not present do not override `family`\n        if (options.dnsLookupIpVersion !== undefined) {\n            try {\n                requestOptions.family = dns_ip_version_1.dnsLookupIpVersionToFamily(options.dnsLookupIpVersion);\n            }\n            catch (_f) {\n                throw new Error('Invalid `dnsLookupIpVersion` option value');\n            }\n        }\n        // HTTPS options remapping\n        if (options.https) {\n            if ('rejectUnauthorized' in options.https) {\n                requestOptions.rejectUnauthorized = options.https.rejectUnauthorized;\n            }\n            if (options.https.checkServerIdentity) {\n                requestOptions.checkServerIdentity = options.https.checkServerIdentity;\n            }\n            if (options.https.certificateAuthority) {\n                requestOptions.ca = options.https.certificateAuthority;\n            }\n            if (options.https.certificate) {\n                requestOptions.cert = options.https.certificate;\n            }\n            if (options.https.key) {\n                requestOptions.key = options.https.key;\n            }\n            if (options.https.passphrase) {\n                requestOptions.passphrase = options.https.passphrase;\n            }\n            if (options.https.pfx) {\n                requestOptions.pfx = options.https.pfx;\n            }\n        }\n        try {\n            let requestOrResponse = await fn(url, requestOptions);\n            if (is_1.default.undefined(requestOrResponse)) {\n                requestOrResponse = fallbackFn(url, requestOptions);\n            }\n            // Restore options\n            options.request = request;\n            options.timeout = timeout;\n            options.agent = agent;\n            // HTTPS options restore\n            if (options.https) {\n                if ('rejectUnauthorized' in options.https) {\n                    delete requestOptions.rejectUnauthorized;\n                }\n                if (options.https.checkServerIdentity) {\n                    // @ts-expect-error - This one will be removed when we remove the alias.\n                    delete requestOptions.checkServerIdentity;\n                }\n                if (options.https.certificateAuthority) {\n                    delete requestOptions.ca;\n                }\n                if (options.https.certificate) {\n                    delete requestOptions.cert;\n                }\n                if (options.https.key) {\n                    delete requestOptions.key;\n                }\n                if (options.https.passphrase) {\n                    delete requestOptions.passphrase;\n                }\n                if (options.https.pfx) {\n                    delete requestOptions.pfx;\n                }\n            }\n            if (isClientRequest(requestOrResponse)) {\n                this._onRequest(requestOrResponse);\n                // Emit the response after the stream has been ended\n            }\n            else if (this.writable) {\n                this.once('finish', () => {\n                    void this._onResponse(requestOrResponse);\n                });\n                this._unlockWrite();\n                this.end();\n                this._lockWrite();\n            }\n            else {\n                void this._onResponse(requestOrResponse);\n            }\n        }\n        catch (error) {\n            if (error instanceof CacheableRequest.CacheError) {\n                throw new CacheError(error, this);\n            }\n            throw new RequestError(error.message, error, this);\n        }\n    }\n    async _error(error) {\n        try {\n            for (const hook of this.options.hooks.beforeError) {\n                // eslint-disable-next-line no-await-in-loop\n                error = await hook(error);\n            }\n        }\n        catch (error_) {\n            error = new RequestError(error_.message, error_, this);\n        }\n        this.destroy(error);\n    }\n    _beforeError(error) {\n        if (this[kStopReading]) {\n            return;\n        }\n        const { options } = this;\n        const retryCount = this.retryCount + 1;\n        this[kStopReading] = true;\n        if (!(error instanceof RequestError)) {\n            error = new RequestError(error.message, error, this);\n        }\n        const typedError = error;\n        const { response } = typedError;\n        void (async () => {\n            if (response && !response.body) {\n                response.setEncoding(this._readableState.encoding);\n                try {\n                    response.rawBody = await get_buffer_1.default(response);\n                    response.body = response.rawBody.toString();\n                }\n                catch (_a) { }\n            }\n            if (this.listenerCount('retry') !== 0) {\n                let backoff;\n                try {\n                    let retryAfter;\n                    if (response && 'retry-after' in response.headers) {\n                        retryAfter = Number(response.headers['retry-after']);\n                        if (Number.isNaN(retryAfter)) {\n                            retryAfter = Date.parse(response.headers['retry-after']) - Date.now();\n                            if (retryAfter <= 0) {\n                                retryAfter = 1;\n                            }\n                        }\n                        else {\n                            retryAfter *= 1000;\n                        }\n                    }\n                    backoff = await options.retry.calculateDelay({\n                        attemptCount: retryCount,\n                        retryOptions: options.retry,\n                        error: typedError,\n                        retryAfter,\n                        computedValue: calculate_retry_delay_1.default({\n                            attemptCount: retryCount,\n                            retryOptions: options.retry,\n                            error: typedError,\n                            retryAfter,\n                            computedValue: 0\n                        })\n                    });\n                }\n                catch (error_) {\n                    void this._error(new RequestError(error_.message, error_, this));\n                    return;\n                }\n                if (backoff) {\n                    const retry = async () => {\n                        try {\n                            for (const hook of this.options.hooks.beforeRetry) {\n                                // eslint-disable-next-line no-await-in-loop\n                                await hook(this.options, typedError, retryCount);\n                            }\n                        }\n                        catch (error_) {\n                            void this._error(new RequestError(error_.message, error, this));\n                            return;\n                        }\n                        // Something forced us to abort the retry\n                        if (this.destroyed) {\n                            return;\n                        }\n                        this.destroy();\n                        this.emit('retry', retryCount, error);\n                    };\n                    this[kRetryTimeout] = setTimeout(retry, backoff);\n                    return;\n                }\n            }\n            void this._error(typedError);\n        })();\n    }\n    _read() {\n        this[kTriggerRead] = true;\n        const response = this[kResponse];\n        if (response && !this[kStopReading]) {\n            // We cannot put this in the `if` above\n            // because `.read()` also triggers the `end` event\n            if (response.readableLength) {\n                this[kTriggerRead] = false;\n            }\n            let data;\n            while ((data = response.read()) !== null) {\n                this[kDownloadedSize] += data.length;\n                this[kStartedReading] = true;\n                const progress = this.downloadProgress;\n                if (progress.percent < 1) {\n                    this.emit('downloadProgress', progress);\n                }\n                this.push(data);\n            }\n        }\n    }\n    // Node.js 12 has incorrect types, so the encoding must be a string\n    _write(chunk, encoding, callback) {\n        const write = () => {\n            this._writeRequest(chunk, encoding, callback);\n        };\n        if (this.requestInitialized) {\n            write();\n        }\n        else {\n            this[kJobs].push(write);\n        }\n    }\n    _writeRequest(chunk, encoding, callback) {\n        if (this[kRequest].destroyed) {\n            // Probably the `ClientRequest` instance will throw\n            return;\n        }\n        this._progressCallbacks.push(() => {\n            this[kUploadedSize] += Buffer.byteLength(chunk, encoding);\n            const progress = this.uploadProgress;\n            if (progress.percent < 1) {\n                this.emit('uploadProgress', progress);\n            }\n        });\n        // TODO: What happens if it's from cache? Then this[kRequest] won't be defined.\n        this[kRequest].write(chunk, encoding, (error) => {\n            if (!error && this._progressCallbacks.length > 0) {\n                this._progressCallbacks.shift()();\n            }\n            callback(error);\n        });\n    }\n    _final(callback) {\n        const endRequest = () => {\n            // FIX: Node.js 10 calls the write callback AFTER the end callback!\n            while (this._progressCallbacks.length !== 0) {\n                this._progressCallbacks.shift()();\n            }\n            // We need to check if `this[kRequest]` is present,\n            // because it isn't when we use cache.\n            if (!(kRequest in this)) {\n                callback();\n                return;\n            }\n            if (this[kRequest].destroyed) {\n                callback();\n                return;\n            }\n            this[kRequest].end((error) => {\n                if (!error) {\n                    this[kBodySize] = this[kUploadedSize];\n                    this.emit('uploadProgress', this.uploadProgress);\n                    this[kRequest].emit('upload-complete');\n                }\n                callback(error);\n            });\n        };\n        if (this.requestInitialized) {\n            endRequest();\n        }\n        else {\n            this[kJobs].push(endRequest);\n        }\n    }\n    _destroy(error, callback) {\n        var _a;\n        this[kStopReading] = true;\n        // Prevent further retries\n        clearTimeout(this[kRetryTimeout]);\n        if (kRequest in this) {\n            this[kCancelTimeouts]();\n            // TODO: Remove the next `if` when these get fixed:\n            // - https://github.com/nodejs/node/issues/32851\n            if (!((_a = this[kResponse]) === null || _a === void 0 ? void 0 : _a.complete)) {\n                this[kRequest].destroy();\n            }\n        }\n        if (error !== null && !is_1.default.undefined(error) && !(error instanceof RequestError)) {\n            error = new RequestError(error.message, error, this);\n        }\n        callback(error);\n    }\n    get _isAboutToError() {\n        return this[kStopReading];\n    }\n    /**\n    The remote IP address.\n    */\n    get ip() {\n        var _a;\n        return (_a = this.socket) === null || _a === void 0 ? void 0 : _a.remoteAddress;\n    }\n    /**\n    Indicates whether the request has been aborted or not.\n    */\n    get aborted() {\n        var _a, _b, _c;\n        return ((_b = (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.destroyed) !== null && _b !== void 0 ? _b : this.destroyed) && !((_c = this[kOriginalResponse]) === null || _c === void 0 ? void 0 : _c.complete);\n    }\n    get socket() {\n        var _a, _b;\n        return (_b = (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.socket) !== null && _b !== void 0 ? _b : undefined;\n    }\n    /**\n    Progress event for downloading (receiving a response).\n    */\n    get downloadProgress() {\n        let percent;\n        if (this[kResponseSize]) {\n            percent = this[kDownloadedSize] / this[kResponseSize];\n        }\n        else if (this[kResponseSize] === this[kDownloadedSize]) {\n            percent = 1;\n        }\n        else {\n            percent = 0;\n        }\n        return {\n            percent,\n            transferred: this[kDownloadedSize],\n            total: this[kResponseSize]\n        };\n    }\n    /**\n    Progress event for uploading (sending a request).\n    */\n    get uploadProgress() {\n        let percent;\n        if (this[kBodySize]) {\n            percent = this[kUploadedSize] / this[kBodySize];\n        }\n        else if (this[kBodySize] === this[kUploadedSize]) {\n            percent = 1;\n        }\n        else {\n            percent = 0;\n        }\n        return {\n            percent,\n            transferred: this[kUploadedSize],\n            total: this[kBodySize]\n        };\n    }\n    /**\n    The object contains the following properties:\n\n    - `start` - Time when the request started.\n    - `socket` - Time when a socket was assigned to the request.\n    - `lookup` - Time when the DNS lookup finished.\n    - `connect` - Time when the socket successfully connected.\n    - `secureConnect` - Time when the socket securely connected.\n    - `upload` - Time when the request finished uploading.\n    - `response` - Time when the request fired `response` event.\n    - `end` - Time when the response fired `end` event.\n    - `error` - Time when the request fired `error` event.\n    - `abort` - Time when the request fired `abort` event.\n    - `phases`\n        - `wait` - `timings.socket - timings.start`\n        - `dns` - `timings.lookup - timings.socket`\n        - `tcp` - `timings.connect - timings.lookup`\n        - `tls` - `timings.secureConnect - timings.connect`\n        - `request` - `timings.upload - (timings.secureConnect || timings.connect)`\n        - `firstByte` - `timings.response - timings.upload`\n        - `download` - `timings.end - timings.response`\n        - `total` - `(timings.end || timings.error || timings.abort) - timings.start`\n\n    If something has not been measured yet, it will be `undefined`.\n\n    __Note__: The time is a `number` representing the milliseconds elapsed since the UNIX epoch.\n    */\n    get timings() {\n        var _a;\n        return (_a = this[kRequest]) === null || _a === void 0 ? void 0 : _a.timings;\n    }\n    /**\n    Whether the response was retrieved from the cache.\n    */\n    get isFromCache() {\n        return this[kIsFromCache];\n    }\n    pipe(destination, options) {\n        if (this[kStartedReading]) {\n            throw new Error('Failed to pipe. The response has been emitted already.');\n        }\n        if (destination instanceof http_1.ServerResponse) {\n            this[kServerResponsesPiped].add(destination);\n        }\n        return super.pipe(destination, options);\n    }\n    unpipe(destination) {\n        if (destination instanceof http_1.ServerResponse) {\n            this[kServerResponsesPiped].delete(destination);\n        }\n        super.unpipe(destination);\n        return this;\n    }\n}\nexports.default = Request;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}