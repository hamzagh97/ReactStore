{"ast":null,"code":"const request = require('request');\n\nconst got = require('got');\n\nconst cheerio = require('cheerio');\n\nvar options = {\n  url: \"\",\n  body: \"\",\n  headers: {\n    'User-Agent': 'Sneaks-API',\n    'Content-Type': 'text/html'\n  }\n};\nmodule.exports = {\n  getLink: async function (shoe, callback) {\n    try {\n      const response = await got.post('https://graphql.stadiumgoods.com/graphql', {\n        headers: {\n          'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15',\n          'Content-Type': 'application/json'\n        },\n        body: '{\"operationId\":\"sg-front/cached-a41eba558ae6325f072164477a24d3c2\",\"variables\":{\"categorySlug\":\"\",\"initialSearchQuery\":\"' + shoe.styleID + '\",\"initialSort\":\"RELEVANCE\",\"includeUnavailableProducts\":null,\"filteringOnCategory\":false,\"filteringOnBrand\":false,\"filteringOnMensSizes\":false,\"filteringOnKidsSizes\":false,\"filteringOnWomensSizes\":false,\"filteringOnApparelSizes\":false,\"filteringOnGender\":false,\"filteringOnColor\":false,\"filteringOnPriceRange\":false},\"locale\":\"USA_USD\"}',\n        http2: true,\n        responseType: 'json'\n      });\n\n      if (response.body.data.configurableProducts.edges[0]) {\n        shoe.resellLinks.stadiumGoods = response.body.data.configurableProducts.edges[0].node.pdpUrl;\n\n        if (response.body.data.configurableProducts.edges[0].node.lowestPrice.__typename == 'DiscountedPrice') {\n          shoe.lowestResellPrice.stadiumGoods = Number(response.body.data.configurableProducts.edges[0].node.lowestPrice.originalValue.formattedValue.replace(/[^0-9.-]+/g, \"\"));\n        } else {\n          shoe.lowestResellPrice.stadiumGoods = Number(response.body.data.configurableProducts.edges[0].node.lowestPrice.value.formattedValue.replace(/[^0-9.-]+/g, \"\"));\n        }\n\n        callback();\n      } else {\n        callback(new Error(\"Product '\" + shoe.styleID + \"' not found on Stadium Goods'\"));\n      }\n    } catch (error) {\n      console.log(error);\n      callback();\n    }\n  },\n  getPrices: function (shoe, callback) {\n    if (!shoe.resellLinks.stadiumGoods) {\n      callback();\n    } else {\n      options.url = shoe.resellLinks.stadiumGoods;\n      let priceMap = {};\n      request.post(options, function getPriceMap(error, response, data) {\n        if (error) {\n          let err = new Error(\"Could not connect to Stadium Goods while searching '\", shoe.styleID, \"' Error: \", error);\n          console.log(err);\n          callback(err);\n        } else if (response.statusCode != 200) {\n          let err = new Error(\"Could not connect to Stadium Goods while searching '\", shoe.styleID, \"' -  Status Code: \", response.statusCode);\n          console.log(err);\n          callback(err);\n        } else {\n          const $ = cheerio.load(data);\n          $('.product-sizes__input').map(function (i, product) {\n            if ($(product).attr('data-stock') == 'true') {\n              var size = $(product).attr('data-size');\n\n              if (size[size.length - 1] == 'W') {\n                size = size.substring(0, size.length - 1);\n              }\n\n              priceMap[size] = parseInt($(product).attr('data-amount')) / 100;\n            }\n\n            if (i == $('.product-sizes__input').length - 1) {\n              shoe.resellPrices.stadiumGoods = priceMap;\n              callback();\n            }\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["request","require","got","cheerio","options","url","body","headers","module","exports","getLink","shoe","callback","response","post","styleID","http2","responseType","data","configurableProducts","edges","resellLinks","stadiumGoods","node","pdpUrl","lowestPrice","__typename","lowestResellPrice","Number","originalValue","formattedValue","replace","value","Error","error","console","log","getPrices","priceMap","getPriceMap","err","statusCode","$","load","map","i","product","attr","size","length","substring","parseInt","resellPrices"],"sources":["C:/Users/hamzu/Desktop/React/React projects/react-store/node_modules/sneaks-api/scrapers/stadiumgoods-scraper.js"],"sourcesContent":["const request = require('request');\nconst got = require('got');\nconst cheerio = require('cheerio');\n\nvar options = {\n    url: \"\",\n    body: \"\",\n    headers: {\n        'User-Agent': 'Sneaks-API',\n        'Content-Type': 'text/html',\n    }\n};\nmodule.exports = {\n    getLink: async function (shoe, callback) {\n        try {\n            const response = await got.post('https://graphql.stadiumgoods.com/graphql', {\n                headers: {\n                    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15',\n                    'Content-Type': 'application/json'\n\n                },\n                body: '{\"operationId\":\"sg-front/cached-a41eba558ae6325f072164477a24d3c2\",\"variables\":{\"categorySlug\":\"\",\"initialSearchQuery\":\"'+shoe.styleID+'\",\"initialSort\":\"RELEVANCE\",\"includeUnavailableProducts\":null,\"filteringOnCategory\":false,\"filteringOnBrand\":false,\"filteringOnMensSizes\":false,\"filteringOnKidsSizes\":false,\"filteringOnWomensSizes\":false,\"filteringOnApparelSizes\":false,\"filteringOnGender\":false,\"filteringOnColor\":false,\"filteringOnPriceRange\":false},\"locale\":\"USA_USD\"}',\n                http2: true,\n                responseType: 'json'\n            });\n\n            if (response.body.data.configurableProducts.edges[0]) {\n                shoe.resellLinks.stadiumGoods = response.body.data.configurableProducts.edges[0].node.pdpUrl;\n                if(response.body.data.configurableProducts.edges[0].node.lowestPrice.__typename == 'DiscountedPrice'){\n                    shoe.lowestResellPrice.stadiumGoods = Number(response.body.data.configurableProducts.edges[0].node.lowestPrice.originalValue.formattedValue.replace(/[^0-9.-]+/g, \"\"));\n                }\n                else{\n                    shoe.lowestResellPrice.stadiumGoods = Number(response.body.data.configurableProducts.edges[0].node.lowestPrice.value.formattedValue.replace(/[^0-9.-]+/g, \"\"));\n\n                }\n                callback();\n            } else {\n                callback(new Error(\"Product '\" + shoe.styleID + \"' not found on Stadium Goods'\"));\n            }\n        } catch (error) {\n            console.log(error);\n            callback();\n        }\n    },\n\n    getPrices: function (shoe, callback) {\n        if (!shoe.resellLinks.stadiumGoods) {\n            callback()\n        } else {\n            options.url = shoe.resellLinks.stadiumGoods;\n            let priceMap = {};\n            request.post(options,\n                function getPriceMap(error, response, data) {\n                    if (error) {\n                        let err = new Error(\"Could not connect to Stadium Goods while searching '\", shoe.styleID, \"' Error: \", error)\n                        console.log(err);\n                        callback(err)\n                    } else if (response.statusCode != 200) {\n                        let err = new Error(\"Could not connect to Stadium Goods while searching '\", shoe.styleID, \"' -  Status Code: \", response.statusCode)\n                        console.log(err);\n                        callback(err)\n                    } else {\n                        const $ = cheerio.load(data);\n                        $('.product-sizes__input').map(function (i, product) {\n                            if ($(product).attr('data-stock') == 'true') {\n                                var size = $(product).attr('data-size');\n                                if(size[size.length-1]=='W'){\n                                    size = size.substring(0, size.length - 1);\n                                }\n                                priceMap[size] = parseInt($(product).attr('data-amount')) / 100;\n                            }\n                            if (i == $('.product-sizes__input').length - 1) {\n                                shoe.resellPrices.stadiumGoods = priceMap;\n                                callback();\n                            }\n                        });\n                    }\n                });\n        }\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}