{"ast":null,"code":"const Sneaker = require('../models/Sneaker');\n\nconst stockXScraper = require('../scrapers/stockx-scraper');\n\nconst flightClubScraper = require('../scrapers/flightclub-scraper');\n\nconst goatScraper = require('../scrapers/goat-scraper');\n\nconst stadiumGoodsScraper = require('../scrapers/stadiumgoods-scraper');\n\nmodule.exports = class Sneaks {\n  /* findOne (shoeID, callback) {\n   Sneaker.findOne({\n     styleID: shoeID\n   }, function (err, shoe) {\n     if (err) {\n       console.log(err);\n       callback(err, null);\n     }\n     callback(null, shoe)\n   });\n  };*/\n\n  /*exports.create = async function (req, res) {\n    if (!req.params) {\n      return res.status(400).send({\n        message: \"Shoe parameters can not be empty\"\n      });\n    }\n    getProducts(req.params.shoe, function (error, products) {\n      if (error) {\n         console.log(error)\n        res.send(\"Product Not Found\");\n      } else {\n        res.json(products);\n      }\n    });\n  };*/\n  async getProducts(keyword) {\n    let count = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 40;\n    let callback = arguments.length > 2 ? arguments[2] : undefined;\n    var productCounter = 0;\n    stockXScraper.getProductsAndInfo(keyword, count, function (error, products) {\n      if (error) {\n        callback(error, null);\n      }\n\n      products.forEach(function (shoe) {\n        var cbCounter = 0;\n        flightClubScraper.getLink(shoe, function () {\n          if (++cbCounter == 3) {\n            //if all shoes links have been parsed then return\n            if (productCounter++ + 1 == products.length) {\n              callback(null, products);\n            }\n          }\n        });\n        stadiumGoodsScraper.getLink(shoe, function () {\n          if (++cbCounter == 3) {\n            //if all shoes links have been parsed then return\n            if (productCounter++ + 1 == products.length) {\n              callback(null, products);\n            }\n          }\n        });\n        goatScraper.getLink(shoe, function () {\n          if (++cbCounter == 3) {\n            //if all shoes links have been parsed then return\n            if (productCounter++ + 1 == products.length) {\n              callback(null, products);\n            }\n          }\n        });\n      });\n    });\n  }\n\n  getProductPrices(shoeID, callback) {\n    const getPrices = shoe => {\n      var cbCounter = 0;\n      stockXScraper.getPrices(shoe, function () {\n        cbCounter++;\n\n        if (cbCounter == 5) {\n          callback(null, shoe);\n        }\n      });\n      stadiumGoodsScraper.getPrices(shoe, function () {\n        cbCounter++;\n\n        if (cbCounter == 5) {\n          callback(null, shoe);\n        }\n      });\n      flightClubScraper.getPrices(shoe, function () {\n        cbCounter++;\n\n        if (cbCounter == 5) {\n          callback(null, shoe);\n        }\n      });\n      goatScraper.getPrices(shoe, function () {\n        cbCounter++;\n\n        if (cbCounter == 5) {\n          callback(null, shoe);\n        }\n      });\n      goatScraper.getPictures(shoe, function () {\n        cbCounter++;\n\n        if (cbCounter == 5) {\n          callback(null, shoe);\n        }\n      });\n    };\n\n    getProducts(shoeID, 1, function (error, products) {\n      if (error || products[0].styleID.toLowerCase() != shoeID.toLowerCase()) {\n        console.log(new Error(\"No Products Found\"));\n        callback(new Error(\"No Products Found\"), null);\n        return;\n      }\n\n      getPrices(products[0]);\n    });\n  }\n\n  /*findAll(callback) {\n    Sneaker.find()\n      .then(sneaks => {\n        callback(null, sneaks);\n      }).catch(err => {\n        callback(err, null)\n      });\n  };*/\n  getMostPopular(count, callback) {\n    getProducts(\"\", count, function (error, products) {\n      if (error) {\n        callback(error, null);\n      } else {\n        callback(null, products);\n      }\n    });\n  }\n\n};\n\nvar getProducts = function (keyword) {\n  let count = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 40;\n  let callback = arguments.length > 2 ? arguments[2] : undefined;\n  var productCounter = 0;\n  stockXScraper.getProductsAndInfo(keyword, count, function (error, products) {\n    if (error) {\n      callback(error, null);\n    }\n\n    products.forEach(function (shoe) {\n      var cbCounter = 0;\n      flightClubScraper.getLink(shoe, function () {\n        if (++cbCounter == 3) {\n          //if all shoes links have been parsed then return\n          if (productCounter++ + 1 == products.length) {\n            callback(null, products);\n          }\n        }\n      });\n      stadiumGoodsScraper.getLink(shoe, function () {\n        if (++cbCounter == 3) {\n          //if all shoes links have been parsed then return\n          if (productCounter++ + 1 == products.length) {\n            callback(null, products);\n          }\n        }\n      });\n      goatScraper.getLink(shoe, function () {\n        if (++cbCounter == 3) {\n          //if all shoes links have been parsed then return\n          if (productCounter++ + 1 == products.length) {\n            callback(null, products);\n          }\n        }\n      });\n    });\n  });\n};","map":{"version":3,"names":["Sneaker","require","stockXScraper","flightClubScraper","goatScraper","stadiumGoodsScraper","module","exports","Sneaks","getProducts","keyword","count","callback","productCounter","getProductsAndInfo","error","products","forEach","shoe","cbCounter","getLink","length","getProductPrices","shoeID","getPrices","getPictures","styleID","toLowerCase","console","log","Error","getMostPopular"],"sources":["C:/Users/hamzu/Desktop/React/React projects/react-store/node_modules/sneaks-api/controllers/sneaks.controllers.js"],"sourcesContent":["const Sneaker = require('../models/Sneaker');\nconst stockXScraper = require('../scrapers/stockx-scraper');\nconst flightClubScraper = require('../scrapers/flightclub-scraper');\nconst goatScraper = require('../scrapers/goat-scraper');\nconst stadiumGoodsScraper = require('../scrapers/stadiumgoods-scraper');\n\nmodule.exports = class Sneaks {\n    /* findOne (shoeID, callback) {\n     Sneaker.findOne({\n       styleID: shoeID\n     }, function (err, shoe) {\n       if (err) {\n         console.log(err);\n         callback(err, null);\n       }\n       callback(null, shoe)\n     });\n   };*/\n\n  /*exports.create = async function (req, res) {\n    if (!req.params) {\n      return res.status(400).send({\n        message: \"Shoe parameters can not be empty\"\n      });\n    }\n    getProducts(req.params.shoe, function (error, products) {\n      if (error) {\n\n        console.log(error)\n        res.send(\"Product Not Found\");\n      } else {\n        res.json(products);\n      }\n    });\n  };*/\n  async getProducts(keyword, count = 40, callback) {\n\n    var productCounter = 0;\n    stockXScraper.getProductsAndInfo(keyword, count, function (error, products) {\n      if (error) {\n        callback(error, null)\n      }\n      products.forEach(function (shoe) {\n        var cbCounter = 0;\n        flightClubScraper.getLink(shoe, function () {\n          if (++cbCounter == 3) {\n            //if all shoes links have been parsed then return\n            if (productCounter++ + 1 == products.length) {\n              callback(null, products);\n            }\n\n          }\n        });\n\n        stadiumGoodsScraper.getLink(shoe, function () {\n          if (++cbCounter == 3) {\n            //if all shoes links have been parsed then return\n            if (productCounter++ + 1 == products.length) {\n              callback(null, products);\n            }\n\n          }\n        });\n\n        goatScraper.getLink(shoe, function () {\n          if (++cbCounter == 3) {\n            //if all shoes links have been parsed then return\n            if (productCounter++ + 1 == products.length) {\n              callback(null, products);\n            }\n\n          }\n        });\n      });\n\n    });\n\n\n  }\n\n  getProductPrices(shoeID, callback) {\n    const getPrices = (shoe) => {\n      var cbCounter = 0;\n      stockXScraper.getPrices(shoe, function () {\n        cbCounter++;\n        if (cbCounter == 5) {\n          callback(null, shoe)\n        }\n      });\n      stadiumGoodsScraper.getPrices(shoe, function () {\n        cbCounter++;\n        if (cbCounter == 5) {\n          callback(null, shoe)\n        }\n\n      });\n      flightClubScraper.getPrices(shoe, function () {\n        cbCounter++;\n        if (cbCounter == 5) {\n          callback(null, shoe)\n        }\n\n      });\n      goatScraper.getPrices(shoe, function () {\n        cbCounter++;\n        if (cbCounter == 5) {\n          callback(null, shoe)\n        }\n      });\n      goatScraper.getPictures(shoe, function () {\n        cbCounter++;\n        if (cbCounter == 5) {\n          callback(null, shoe)\n        }\n      });\n    }\n\n    getProducts(shoeID, 1, function (error, products) {\n      if (error || products[0].styleID.toLowerCase() != shoeID.toLowerCase()) {\n        console.log(new Error(\"No Products Found\"));\n        callback(new Error(\"No Products Found\"), null);\n        return;\n      }\n      getPrices(products[0]);\n    });\n  };\n\n  /*findAll(callback) {\n    Sneaker.find()\n      .then(sneaks => {\n        callback(null, sneaks);\n      }).catch(err => {\n        callback(err, null)\n      });\n  };*/\n\n  getMostPopular(count, callback) {\n    getProducts(\"\", count, function (error, products) {\n      if (error) {\n        callback(error, null);\n      } else {\n        callback(null, products)\n      }\n    });\n  };\n}\n\n\nvar getProducts = function (keyword, count = 40, callback) {\n  var productCounter = 0;\n  stockXScraper.getProductsAndInfo(keyword, count, function (error, products) {\n    if (error) {\n      callback(error, null)\n    }\n    products.forEach(function (shoe) {\n      var cbCounter = 0;\n      flightClubScraper.getLink(shoe, function () {\n        if (++cbCounter == 3) {\n          //if all shoes links have been parsed then return\n          if (productCounter++ + 1 == products.length) {\n            callback(null, products);\n          }\n        }\n      });\n\n      stadiumGoodsScraper.getLink(shoe, function () {\n        if (++cbCounter == 3) {\n          //if all shoes links have been parsed then return\n          if (productCounter++ + 1 == products.length) {\n            callback(null, products);\n          }\n\n        }\n      });\n\n      goatScraper.getLink(shoe, function () {\n        if (++cbCounter == 3) {\n          //if all shoes links have been parsed then return\n          if (productCounter++ + 1 == products.length) {\n            callback(null, products);\n          }\n        }\n      });\n    });\n  });\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}